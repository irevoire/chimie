import"./DsnmJJEf.js";import{p as q,h as A,i as K,P as Q,j as g,s as y,c as I,a as G,t as w,g as t,u as x,n as B,r as P}from"./BOqQhZBJ.js";import{d as U,a as W,s as D,e as X}from"./BufZg4h2.js";import{f as V,a as b,t as F}from"./CnteGC4G.js";import{i as J}from"./QS5y7wlf.js";import{p as h,c as Y,a as Z,s as ee}from"./B227BkWK.js";import{e as te,i as ae,t as re,h as oe}from"./D4fmOnVC.js";import{r as se,s as j,B as O}from"./LrV5ZTyj.js";import{L as ne,b as ie}from"./eLOR7anR.js";import{L as le}from"./DeYUhNiz.js";import{$ as ue}from"./DdY9CyNE.js";import{H as ce}from"./Ze2c3aZz.js";var fe=V('<input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="h-12 w-10 rounded-xl border-2 border-suble dark:border-gray-700 text-center text-lg font-medium focus:border-immich-primary focus:ring-primary dark:focus:border-primary font-mono bg-white dark:bg-light"/>'),de=V('<div class="flex flex-col gap-1"><!> <div class="flex gap-2"></div></div>');function R(M,n){q(n,!0);let s=h(n,"value",15,""),f=h(n,"pinLength",3,6),z=h(n,"tabindexStart",3,0),E=h(n,"autofocus",3,!1),d=h(n,"type",3,"text"),i=A(K(Array.from({length:f()}).fill(""))),c=K([]);Q(()=>{s()===""&&g(i,Array.from({length:f()}).fill(""),!0)}),W(()=>{E()&&c[0]?.focus()});const $=a=>{c[Math.min(a+1,f()-1)]?.focus()},k=a=>{a>0&&c[a-1]?.focus()},H=(a,l)=>{const e=a.target;let r=e.value;if(e.value.length>1&&(r=s().slice(0,1)),Number.isNaN(Number(s()))){t(i)[l]="",e.value="";return}t(i)[l]=r,s(t(i).join("").trim()),s()&&l<f()-1&&$(l),s().length===f()&&n.onFilled?.(s())};function C(a){const l=a.currentTarget,e=c.indexOf(l);switch(a.key){case"Tab":return;case"Backspace":{l.value===""&&e>0?(k(e),t(i)[e-1]=""):l.value!==""&&(t(i)[e]=""),s(t(i).join("").trim());return}case"ArrowLeft":{e>0&&k(e);return}case"ArrowRight":{e<f()-1&&$(e);return}default:{Number.isNaN(Number(a.key))&&a.preventDefault();break}}}var m=de(),_=I(m);{var L=a=>{{let l=x(()=>c[0]?.id);ne(a,{get for(){return t(l)},children:(e,r)=>{B();var u=F();w(()=>D(u,n.label)),b(e,u)},$$slots:{default:!0}})}};J(_,a=>{n.label&&a(L)})}var N=y(_,2);te(N,21,()=>({length:f()}),ae,(a,l,e)=>{var r=fe();se(r),j(r,"id",`pin-code-${e}`),r.__keydown=C,r.__input=u=>H(u,e),Y(r,(u,o)=>c[o]=u,u=>c?.[u],()=>[e]),w(()=>{j(r,"tabindex",z()+e),j(r,"type",d()),j(r,"aria-label",`PIN digit ${e+1} of ${f()}${n.label?` for ${n.label}`:""}`)}),ie(r,()=>t(i)[e],u=>t(i)[e]=u),b(a,r)}),P(N),P(m),b(M,m),G()}U(["keydown","input"]);var me=V('<form autocomplete="off"><div class="flex flex-col gap-6 place-items-center place-content-center"><!> <!> <!></div> <div class="flex justify-end gap-2 mt-4"><!> <!></div></form>');function Ce(M,n){q(n,!0);const s=()=>Z(ue,"$t",f),[f,z]=ee();let E=h(n,"showLabel",3,!0),d=A(""),i=A(""),c=A(!1),$=x(()=>t(i).length===6&&t(d)===t(i));const k=async o=>{o.preventDefault(),await H()},H=async()=>{g(c,!0);try{await le({pinCodeSetupDto:{pinCode:t(d)}}),re.success(s()("pin_code_setup_successfully")),n.onCreated?.(t(d)),C()}catch(o){oe(o,s()("unable_to_setup_pin_code"))}finally{g(c,!1)}},C=()=>{g(d,""),g(i,"")};var m=me(),_=I(m),L=I(_);{var N=o=>{ce(o,{children:(p,S)=>{B();var v=F();w(T=>D(v,T),[()=>s()("setup_pin_code")]),b(p,v)},$$slots:{default:!0}})};J(L,o=>{E()&&o(N)})}var a=y(L,2);{let o=x(()=>s()("new_pin_code"));R(a,{get label(){return t(o)},tabindexStart:1,pinLength:6,get value(){return t(d)},set value(p){g(d,p,!0)}})}var l=y(a,2);{let o=x(()=>s()("confirm_new_pin_code"));R(l,{get label(){return t(o)},tabindexStart:7,pinLength:6,get value(){return t(i)},set value(p){g(i,p,!0)}})}P(_);var e=y(_,2),r=I(e);O(r,{shape:"round",color:"secondary",type:"button",size:"small",onclick:C,children:(o,p)=>{B();var S=F();w(v=>D(S,v),[()=>s()("clear")]),b(o,S)},$$slots:{default:!0}});var u=y(r,2);{let o=x(()=>!t($));O(u,{shape:"round",type:"submit",size:"small",get loading(){return t(c)},get disabled(){return t(o)},children:(p,S)=>{B();var v=F();w(T=>D(v,T),[()=>s()("create")]),b(p,v)},$$slots:{default:!0}})}P(e),P(m),X("submit",m,k),b(M,m),G(),z()}export{R as P,Ce as a};
