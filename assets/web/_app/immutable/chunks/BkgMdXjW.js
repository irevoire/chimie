const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_app/immutable/chunks/BEfn6cqG.js","_app/immutable/chunks/DsnmJJEf.js","_app/immutable/chunks/BufZg4h2.js","_app/immutable/chunks/BOqQhZBJ.js","_app/immutable/chunks/DIeogL5L.js","_app/immutable/chunks/CnteGC4G.js","_app/immutable/chunks/QS5y7wlf.js","_app/immutable/chunks/D4fmOnVC.js","_app/immutable/chunks/DeYUhNiz.js","_app/immutable/chunks/B_VXSWsl.js","_app/immutable/chunks/B227BkWK.js","_app/immutable/chunks/LrV5ZTyj.js","_app/immutable/chunks/C4XZXykC.js","_app/immutable/chunks/BUApaBEI.js","_app/immutable/assets/Logo.BzPWps5k.css","_app/immutable/chunks/4T_x9N89.js","_app/immutable/chunks/CKQ4VlI3.js","_app/immutable/chunks/De1sTUmb.js","_app/immutable/chunks/BNLYq5HQ.js","_app/immutable/chunks/Jagi0WJL.js","_app/immutable/chunks/C2I_EQjW.js","_app/immutable/chunks/DbKlvrsB.js","_app/immutable/chunks/ytu5q_IM.js","_app/immutable/chunks/BeWG-__C.js","_app/immutable/chunks/DdY9CyNE.js","_app/immutable/chunks/Cx5lmlld.js","_app/immutable/chunks/_U16pX41.js","_app/immutable/chunks/Bp2HQ4kn.js","_app/immutable/chunks/CT-ELVN-.js","_app/immutable/chunks/ClWsMFS7.js","_app/immutable/chunks/Bz1BELIr.js","_app/immutable/chunks/eLOR7anR.js","_app/immutable/chunks/Clv0aeC8.js","_app/immutable/chunks/DFvk55M8.js","_app/immutable/chunks/DsCc9Mx1.js","_app/immutable/chunks/CsUlL5WR.js","_app/immutable/chunks/CYAb_6oJ.js","_app/immutable/chunks/CS-10t6W.js","_app/immutable/chunks/BihPMor6.js","_app/immutable/chunks/C20f7eOz.js","_app/immutable/chunks/Ze2c3aZz.js","_app/immutable/chunks/Vqhp0wrh.js","_app/immutable/chunks/BIB7ntQe.js","_app/immutable/chunks/BjCgVxgW.js","_app/immutable/chunks/DnqqNi3p.js","_app/immutable/chunks/D5h9ps2j.js","_app/immutable/chunks/CH9-R8qO.js","_app/immutable/chunks/C9pIfr-B.js","_app/immutable/chunks/BbGcRfD-.js","_app/immutable/chunks/BHgwLGQu.js","_app/immutable/chunks/69_IOA4Y.js","_app/immutable/chunks/CMtyP6CA.js","_app/immutable/chunks/CRYXttfP.js","_app/immutable/chunks/9i_j0jQI.js","_app/immutable/chunks/1WjNB9m1.js","_app/immutable/chunks/Bc5ULZvy.js","_app/immutable/chunks/C0Ca_l_S.js","_app/immutable/chunks/LRhZRw-S.js","_app/immutable/chunks/CBNU4HUx.js","_app/immutable/chunks/DzmAA-7p.js","_app/immutable/chunks/BJT5MMCK.js","_app/immutable/assets/Input.DUYXNfxO.css","_app/immutable/chunks/DHEjuV7w.js","_app/immutable/chunks/rybNiN9i.js","_app/immutable/chunks/CaDSsDA9.js","_app/immutable/chunks/FIvvbHQR.js","_app/immutable/chunks/yWuLE-qO.js","_app/immutable/chunks/izWpGtDw.js","_app/immutable/chunks/ngppk3MK.js","_app/immutable/chunks/BSBkdVh4.js","_app/immutable/chunks/BTHsrYEL.js","_app/immutable/chunks/y_IyUkeW.js","_app/immutable/chunks/Ydc33-3A.js","_app/immutable/chunks/ClLqiWoK.js","_app/immutable/chunks/BmZTbFl5.js","_app/immutable/chunks/BCL4P6ef.js","_app/immutable/chunks/SuizJy8Y.js","_app/immutable/chunks/Di6OVBka.js","_app/immutable/chunks/B6A-PVC5.js","_app/immutable/chunks/BXaFREg4.js","_app/immutable/assets/Textarea.M6eTxvbo.css","_app/immutable/assets/activity-viewer.CwxlvmcY.css","_app/immutable/chunks/B1PyaZbq.js","_app/immutable/assets/thumbnail.Di7rqjOL.css","_app/immutable/chunks/ghntbn61.js","_app/immutable/chunks/6ckOa7Ax.js","_app/immutable/chunks/Bj7pQby1.js","_app/immutable/chunks/Dj0AsE1j.js","_app/immutable/chunks/zKTaOrsI.js","_app/immutable/chunks/DxfhPdFw.js","_app/immutable/chunks/CaTmVaxL.js","_app/immutable/chunks/CsIzZJ43.js","_app/immutable/chunks/8PJ7VpFA.js","_app/immutable/chunks/BzKamodV.js","_app/immutable/chunks/D-O87UL4.js","_app/immutable/chunks/o4H9mija.js","_app/immutable/assets/asset-viewer.CSooJwqO.css"])))=>i.map(i=>d[i]);
import"./DsnmJJEf.js";import{p as de,$ as xe,f as P,c as h,r as f,s as m,t as se,j as Z,h as ee,g as e,u as p,a as ce,i as O,aW as Fe,n as Ge,W as Oe}from"./BOqQhZBJ.js";import{s as oe,e as Ue}from"./BufZg4h2.js";import{f as w,a as l,c as ve,t as ze}from"./CnteGC4G.js";import{i as k}from"./QS5y7wlf.js";import{h as He}from"./CkzyFknU.js";import{L as fe,I as X,bF as ye,bG as qe,a4 as Se,a1 as We,a6 as je,ah as Qe,s as Xe,B as Je}from"./LrV5ZTyj.js";import{p as Le,a as U,s as me,d as Ke,e as Ye}from"./B227BkWK.js";import{a as Ze}from"./4T_x9N89.js";import{A as et,g as tt}from"./Bp2HQ4kn.js";import{A as at,a as rt}from"./Di5YHdw_.js";import{D as Ie}from"./CAJBNUk5.js";import{S as st}from"./KeI0xpXW.js";import{A as De}from"./DYbeYGSx.js";import{T as ot}from"./-MdfcuX_.js";import{f as nt}from"./D5h9ps2j.js";import{a as _e,b as it}from"./C2I_EQjW.js";import{h as he,a as Pe,d as lt,X as dt}from"./Jagi0WJL.js";import{aD as ct,f as mt,S as we,aE as ut}from"./DeYUhNiz.js";import{$ as ue}from"./DdY9CyNE.js";import{h as vt}from"./BTiqhowq.js";import{A as Me}from"./DeL_lkPB.js";import{a as Re}from"./ngppk3MK.js";import{d as le}from"./AeuhPEE0.js";import{m as Ce}from"./BihPMor6.js";import{S as gt,a as ht,s as ft}from"./y_IyUkeW.js";import{f as Te,o as Be}from"./BjCgVxgW.js";import{C as pe}from"./C9fqHGV9.js";import{T as Ee}from"./S6jRJcg1.js";import{a as pt}from"./_U16pX41.js";import{_ as _t,A as ge}from"./BNLYq5HQ.js";import{a as be}from"./yWuLE-qO.js";import{b as $e}from"./9i_j0jQI.js";import{g as Ae}from"./C4XZXykC.js";import{c as wt}from"./CaDSsDA9.js";import{g as bt}from"./Dw326QmB.js";import{R as ke}from"./BeWG-__C.js";import{t as $t,h as Ve}from"./D4fmOnVC.js";import{t as At}from"./BIB7ntQe.js";import{G as kt}from"./BO7gIFhw.js";import{u as xt}from"./Cx5lmlld.js";import{P as yt}from"./DHEjuV7w.js";var St=w('<p class="whitespace-pre-line mb-12 mt-6 w-full pb-2 text-start font-medium text-base text-black dark:text-gray-300"> </p>'),Lt=w('<section class="pt-8 md:pt-24 px-2 md:px-0"><h1 class="text-2xl md:text-4xl lg:text-6xl text-primary outline-none transition-all"> </h1> <!> <!></section>'),It=w("<!> <!>",1),Dt=w('<a data-sveltekit-preload-data="hover" class="ms-4" href="/"><!></a>'),Pt=w("<!> <!>",1),Mt=w("<!> <!> <!> <!> <!>",1),Rt=w('<main class="relative h-dvh overflow-hidden px-2 md:px-6 max-md:pt-(--navbar-height-md) pt-(--navbar-height)"><!></main> <header><!></header>',1);function Ct(z,_){de(_,!0);const L=()=>U(ae,"$slideshowNavigation",u),x=()=>U(ue,"$t",u),H=()=>U(b,"$showAssetViewer",u),[u,V]=me();let M=Le(_,"user",3,void 0);const a=_.sharedLink.album;let{isViewing:b,setAssetId:R}=Re,{slideshowState:te,slideshowNavigation:ae}=ft;const J=p(()=>({albumId:a.id,order:a.order}));let B=ee(void 0);const I=new Me;le.subscribe(n=>{n.isDragging&&n.files.length>0&&(he(Te({files:n.files,albumId:a.id})),le.set({isDragging:!1,files:[]}))});const K=async()=>{const n=L()===gt.Shuffle?await e(B).getRandomAsset():e(B).months[0]?.dayGroups[0]?.viewerAssets[0]?.asset;n&&he(R(n.id).then(()=>Ke(te,ht.PlaySlideshow)))},o=p(()=>tt(x())),$=p(()=>e(o).Cast);var E=Rt();Ze(xe,(n,A)=>pt?.(n,A),()=>({shortcut:{key:"Escape"},onShortcut:()=>{!H()&&I.selectionActive&&Pe(I)}}));var C=P(E),D=h(C);ot(D,{enableRouting:!0,get album(){return a},get options(){return e(J)},get assetInteraction(){return I},get timelineManager(){return e(B)},set timelineManager(n){Z(B,n,!0)},children:(n,A)=>{var t=Lt(),r=h(t),s=h(r,!0);f(r);var c=m(r,2);{var v=T=>{at(T,{get album(){return a}})};k(c,T=>{a.assetCount>0&&T(v)})}var i=m(c,2);{var g=T=>{var N=St(),W=h(N,!0);f(N),se(()=>oe(W,a.description)),l(T,N)};k(i,T=>{a.description&&T(g)})}f(t),se(()=>oe(s,a.albumName)),l(n,t)},$$slots:{default:!0}}),f(C);var y=m(C,2),q=h(y);{var d=n=>{{let A=p(()=>M()?.id);De(n,{get ownerId(){return e(A)},get assets(){return I.selectedAssets},clearSelect:()=>I.clearMultiselect(),children:(t,r)=>{var s=It(),c=P(s);st(c,{get timelineManager(){return e(B)},get assetInteraction(){return I}});var v=m(c,2);{var i=g=>{Ie(g,{get filename(){return`${a.albumName??""}.zip`}})};k(v,g=>{_.sharedLink.allowDownload&&g(i)})}l(t,s)},$$slots:{default:!0}})}},F=n=>{pe(n,{showBackButton:!1,leading:r=>{var s=Dt(),c=h(s);{let v=p(()=>Ce.maxMd?"icon":"inline");fe(c,{get variant(){return e(v)},class:"min-w-10"})}f(s),l(r,s)},trailing:r=>{var s=Mt(),c=P(s);et(c,{get action(){return e($)}});var v=m(c,2);{var i=S=>{{let j=p(()=>x()("add_photos"));X(S,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(j)},onclick:()=>Be({albumId:a.id}),get icon(){return ye}})}};k(v,S=>{_.sharedLink.allowUpload&&S(i)})}var g=m(v,2);{var T=S=>{var j=Pt(),ie=P(j);{let Q=p(()=>x()("slideshow"));X(ie,{shape:"round",variant:"ghost",color:"secondary",get"aria-label"(){return e(Q)},onclick:K,get icon(){return qe}})}var G=m(ie,2);{let Q=p(()=>x()("download"));X(G,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(Q)},onclick:()=>vt(a),get icon(){return Se}})}l(S,j)};k(g,S=>{a.assetCount>0&&_.sharedLink.allowDownload&&S(T)})}var N=m(g,2);{var W=S=>{rt(S,{get album(){return a}})};k(N,S=>{_.sharedLink.showMetadata&&nt.value.map&&S(W)})}var ne=m(N,2);Ee(ne,{}),l(r,s)},$$slots:{leading:!0,trailing:!0}})};k(q,n=>{I.selectionActive?n(d):n(F,!1)})}f(y),l(z,E),ce(),V()}function Tt(z,_){de(_,!0);const L=()=>U(ue,"$t",x),[x,H]=me(),{getAssets:u,clearSelect:V}=bt(),M=async()=>{const a=u().map(({id:R})=>R);await wt(_.sharedLink,a)&&V()};{let a=p(()=>L()("remove_from_shared_link"));X(z,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(a)},onclick:M,get icon(){return We}})}ce(),H()}var Bt=w("<!> <!> <!>",1),Et=w('<a data-sveltekit-preload-data="hover" class="ms-4" href="/"><!></a>'),Vt=w("<!> <!>",1),Nt=w('<!> <section class="my-40 mx-4"><!></section>',1),Ft=w("<section><!></section>");function Gt(z,_){de(_,!0);const L=()=>U(ue,"$t",x),[x,H]=me();let u=Le(_,"sharedLink",15);const V=O({width:0,height:0}),M=new Me;let a=p(()=>u().assets);le.subscribe(o=>{o.isDragging&&o.files.length>0&&(he(R(o.files)),le.set({isDragging:!1,files:[]}))});const b=async()=>{await lt("immich-shared.zip",{assetIds:e(a).map(o=>o.id)})},R=async(o=[])=>{try{let $=[];$=await(!o||o.length===0||!Array.isArray(o)?Be():Te({files:o}));const C=(await ct({..._e.params,id:u().id,assetIdsDto:{assetIds:$.filter(D=>!!D)}})).filter(D=>D.success).length;$t.success(L()("assets_added_count",{values:{count:C}}))}catch($){Ve($,L()("errors.unable_to_add_assets_to_shared_link"))}},te=()=>{M.selectAssets(e(a).map(o=>At(o)))},ae=async o=>{switch(o.type){case ge.ARCHIVE:case ge.DELETE:case ge.TRASH:{await Ae(ke.photos());break}}};var J=Ft(),B=h(J);{var I=o=>{var $=Nt(),E=P($);{var C=d=>{De(d,{get assets(){return M.selectedAssets},clearSelect:()=>Pe(M),children:(F,n)=>{var A=Bt(),t=P(A);{let i=p(()=>L()("select_all"));X(t,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(i)},get icon(){return je},onclick:te})}var r=m(t,2);{var s=i=>{Ie(i,{filename:"immich-shared.zip"})};k(r,i=>{u()?.allowDownload&&i(s)})}var c=m(r,2);{var v=i=>{Tt(i,{get sharedLink(){return u()},set sharedLink(g){u(g)}})};k(c,i=>{_.isOwned&&i(v)})}l(F,A)},$$slots:{default:!0}})},D=d=>{pe(d,{onClose:()=>Ae(ke.photos()),get backIcon(){return Qe},showBackButton:!1,leading:A=>{var t=Et(),r=h(t);{let s=p(()=>Ce.maxMd?"icon":"inline");fe(r,{get variant(){return e(s)},class:"min-w-10"})}f(t),l(A,t)},trailing:A=>{var t=Vt(),r=P(t);{var s=i=>{{let g=p(()=>L()("add_photos"));X(i,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(g)},onclick:()=>R(),get icon(){return ye}})}};k(r,i=>{u()?.allowUpload&&i(s)})}var c=m(r,2);{var v=i=>{{let g=p(()=>L()("download"));X(i,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(g)},onclick:b,get icon(){return Se}})}};k(c,i=>{u()?.allowDownload&&i(v)})}l(A,t)},$$slots:{leading:!0,trailing:!0}})};k(E,d=>{M.selectionActive?d(C):d(D,!1)})}var y=m(E,2),q=h(y);kt(q,{get assets(){return e(a)},get assetInteraction(){return M},get viewport(){return V}}),f(y),$e(y,"clientHeight",d=>V.height=d),$e(y,"clientWidth",d=>V.width=d),l(o,$)},K=o=>{var $=ve(),E=P($);be(E,()=>mt({..._e.params,id:e(a)[0].id}),null,(C,D)=>{var y=ve(),q=P(y);be(q,()=>_t(()=>import("./BEfn6cqG.js").then(d=>d.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96])),null,(d,F)=>{var n=p(()=>{var{default:s}=e(F);return{AssetViewer:s}}),A=p(()=>e(n).AssetViewer),t=ve(),r=P(t);{let s=p(()=>({current:e(D)}));Ye(r,()=>e(A),(c,v)=>{v(c,{get cursor(){return e(s)},onAction:ae})})}l(d,t)}),l(C,y)}),l(o,$)};k(B,o=>{u()?.allowUpload||e(a).length>1?o(I):e(a).length===1&&o(K,1)})}f(J),l(z,J),ce(),H()}var Ot=w('<meta name="description"/>'),Ut=w('<a data-sveltekit-preload-data="hover" class="ms-4" href="/"><!></a>'),zt=w('<main class="relative h-dvh overflow-hidden px-6 max-md:pt-(--navbar-height-md) pt-(--navbar-height) sm:px-12 md:px-24 lg:px-40"><div class="flex flex-col items-center justify-center mt-20"><div class="text-2xl font-bold text-primary"> </div> <div class="mt-4 text-lg text-primary"> </div> <div class="mt-4"><form class="flex gap-x-2" novalidate=""><!> <!></form></div></div></main> <header><!></header>',1),Ht=w('<div class="immich-scrollbar"><!></div>'),qt=w("<!> <!> <!>",1);function Ta(z,_){de(_,!0);const L=()=>U(xt,"$user",u),x=()=>U(ue,"$t",u),H=()=>U(M,"$gridScrollTarget",u),[u,V]=me();let{gridScrollTarget:M}=Re,a=_.data,b=ee(O(a.sharedLink)),R=ee(O(a.passwordRequired)),te=O(a.key),ae=O(a.slug),B=O(a.meta),I=ee(O(B.title)),K=ee(O(B.description)),o=p(()=>L()?L().id===e(b)?.userId:!1),$=ee("");const E=async()=>{try{Z(b,await ut({key:te,slug:ae,sharedLinkLoginDto:{password:e($)}}),!0),dt(e(b)),Z(R,!1),Z(I,(e(b).album?e(b).album.albumName:x()("public_share"))+" - Immich"),Z(K,e(b).description||x()("shared_photos_and_videos_count",{values:{assetCount:e(b).assets.length}}),!0),await Oe(),await it({targetRoute:"current",assetId:null,assetGridRouteSearchParams:H()},{forceNavigate:!0,replaceState:!0})}catch(t){Ve(t,x()("errors.unable_to_get_shared_link"))}},C=async t=>{t.preventDefault(),await E()};var D=qt();He("5syozd",t=>{var r=Ot();se(()=>Xe(r,"content",e(K))),Fe(()=>{xe.title=e(I)??""}),l(t,r)});var y=P(D);{var q=t=>{var r=zt(),s=P(r),c=h(s),v=h(c),i=h(v,!0);f(v);var g=m(v,2),T=h(g,!0);f(g);var N=m(g,2),W=h(N),ne=h(W);yt(ne,{autocomplete:"off",placeholder:"Password",get value(){return e($)},set value(G){Z($,G,!0)}});var S=m(ne,2);Je(S,{type:"submit",children:(G,Q)=>{Ge();var Y=ze();se(re=>oe(Y,re),[()=>x()("submit")]),l(G,Y)},$$slots:{default:!0}}),f(W),f(N),f(c),f(s);var j=m(s,2),ie=h(j);pe(ie,{showBackButton:!1,leading:Y=>{var re=Ut(),Ne=h(re);fe(Ne,{variant:"inline"}),f(re),l(Y,re)},trailing:Y=>{Ee(Y,{})},$$slots:{leading:!0,trailing:!0}}),f(j),se((G,Q)=>{oe(i,G),oe(T,Q)},[()=>x()("password_required"),()=>x()("sharing_enter_password")]),Ue("submit",W,C),l(t,r)};k(y,t=>{e(R)&&t(q)})}var d=m(y,2);{var F=t=>{Ct(t,{get sharedLink(){return e(b)}})};k(d,t=>{!e(R)&&e(b)?.type==we.Album&&t(F)})}var n=m(d,2);{var A=t=>{var r=Ht(),s=h(r);Gt(s,{get sharedLink(){return e(b)},get isOwned(){return e(o)}}),f(r),l(t,r)};k(n,t=>{!e(R)&&e(b)?.type==we.Individual&&t(A)})}l(z,D),ce(),V()}export{Ta as S};
