import{e as q}from"./ytu5q_IM.js";import"./DsnmJJEf.js";import{p as ue,f as ee,n as ne,t as z,s as u,c as s,j as E,u as l,g as o,r,a as ve,h as be,at as de,W as xe}from"./BOqQhZBJ.js";import{s as K,d as we,a as $e}from"./BufZg4h2.js";import{f as U,t as le,a as y}from"./CnteGC4G.js";import{i as me}from"./QS5y7wlf.js";import{a as _e,s as fe,p as V}from"./B227BkWK.js";import{D as Pe}from"./zKTaOrsI.js";import{t as S,h as C,e as Me}from"./D4fmOnVC.js";import{$ as he,g as L}from"./DdY9CyNE.js";import{_ as W,$ as De}from"./DeYUhNiz.js";import{T as Te,aZ as ke,B as Ue,a0 as Se,$ as Ce,aw as Fe,ax as He,a_ as Ie,a as ce,a$ as Oe,I as Be,b0 as je,ah as Ae,u as ze}from"./LrV5ZTyj.js";import{m as Ee}from"./C20f7eOz.js";import{F as ge}from"./C0Ca_l_S.js";import{r as X}from"./Jagi0WJL.js";import{I as Y}from"./izWpGtDw.js";var qe=U('<div class="flex justify-end"><!></div>'),Le=U('<!> <div class="my-4 flex flex-col gap-2"><!> <!></div>',1);function We(a,e){ue(e,!0);const t=()=>_e(he,"$t",c),[c,F]=fe();let i=l(()=>e.person.birthDate??"");const n=async()=>{await Ne(e.person,o(i))&&e.onClose()},d=new Date().toISOString().split("T")[0];{let v=l(()=>t()("set_date_of_birth"));ge(a,{get title(){return o(v)},size:"small",get icon(){return ke},get onClose(){return e.onClose},onSubmit:n,children:(N,te)=>{var Z=Le(),m=ee(Z);Te(m,{size:"small",children:(_,x)=>{ne();var f=le();z(H=>K(f,H),[()=>t()("birthdate_set_description")]),y(_,f)},$$slots:{default:!0}});var b=u(m,2),P=s(b);Pe(P,{class:"immich-form-input",id:"birthDate",name:"birthDate",type:"date",get max(){return d},get value(){return o(i)},set value(_){E(i,_)}});var M=u(P,2);{var Q=_=>{var x=qe(),f=s(x);Ue(f,{shape:"round",color:"secondary",size:"small",onclick:()=>E(i,""),children:(H,re)=>{ne();var G=le();z(I=>K(G,I),[()=>t()("clear")]),y(H,G)},$$slots:{default:!0}}),r(x),y(_,x)};me(M,_=>{e.person.birthDate&&_(Q)})}r(b),y(N,Z)},$$slots:{default:!0}})}ve(),F()}const ft=(a,e)=>{const t={title:a("set_date_of_birth"),icon:Ie,onAction:()=>Ee.show(We,{person:e})},c={title:a("to_favorite"),icon:He,$if:()=>!e.isFavorite,onAction:()=>Ze(e)},F={title:a("unfavorite"),icon:Fe,$if:()=>!!e.isFavorite,onAction:()=>Ge(e)},i={title:a("hide_person"),icon:Ce,$if:()=>!e.isHidden,onAction:()=>Je(e)},n={title:a("unhide_person"),icon:Se,$if:()=>!!e.isHidden,onAction:()=>Ke(e)};return{SetDateOfBirth:t,Favorite:c,Unfavorite:F,HidePerson:i,ShowPerson:n}},Ze=async a=>{const e=await L();try{const t=await W({id:a.id,personUpdateDto:{isFavorite:!0}});q.emit("PersonUpdate",t),S.success(e("added_to_favorites"))}catch(t){C(t,e("errors.unable_to_add_remove_favorites",{values:{favorite:!1}}))}},Ge=async a=>{const e=await L();try{const t=await W({id:a.id,personUpdateDto:{isFavorite:!1}});q.emit("PersonUpdate",t),S.success(e("removed_from_favorites"))}catch(t){C(t,e("errors.unable_to_add_remove_favorites",{values:{favorite:!1}}))}},Je=async a=>{const e=await L();try{const t=await W({id:a.id,personUpdateDto:{isHidden:!0}});S.success(e("changed_visibility_successfully")),q.emit("PersonUpdate",t)}catch(t){C(t,e("errors.unable_to_hide_person"))}},Ke=async a=>{const e=await L();try{const t=await W({id:a.id,personUpdateDto:{isHidden:!1}});S.success(e("changed_visibility_successfully")),q.emit("PersonUpdate",t)}catch(t){C(t,e("errors.something_went_wrong"))}},Ne=async(a,e)=>{const t=await L();try{const c=await W({id:a.id,personUpdateDto:{birthDate:e}});return S.success(t("date_of_birth_saved")),q.emit("PersonUpdate",c),!0}catch(c){C(c,t("errors.unable_to_save_date_of_birth"))}};var Qe=U('<div class="flex h-20 w-20 items-center px-1 md:h-24 md:w-24 md:px-2"><!></div> <div class="grid grid-rows-3"><div></div> <div class="flex flex-col h-full items-center justify-center"><div class="flex h-full items-center justify-center"><!></div></div> <div><!></div></div> <button type="button" class="flex h-28 w-28 items-center rounded-full border-2 border-immich-primary px-1 dark:border-immich-dark-primary md:h-32 md:w-32 md:px-2"><!></button>',1),Re=U('<div class="h-24 w-24 md:h-28 md:w-28"><button type="button" class="p-2 w-full"><!></button></div>'),Ve=U('<div class="grid w-full grid-cols-1 gap-2"><div class="px-2"><button type="button"><!></button></div> <div class="flex items-center justify-center"><div></div></div></div>'),Xe=U('<div class="flex items-center justify-center gap-2 py-4 md:h-36"><!></div> <div class="flex px-4 md:pt-4"><h1 class="text-xl text-gray-500 dark:text-gray-300"> </h1></div> <div class="flex px-4 pt-2"><p class="text-sm text-gray-500 dark:text-gray-300"> </p></div>',1);function ht(a,e){ue(e,!0);const t=()=>_e(he,"$t",c),[c,F]=fe();let i=V(e,"personToMerge",15),n=V(e,"personToBeMergedInto",15),d=V(e,"potentialMergePeople",15),v=be(!1);const N=n().name,te=m=>{const b=d().indexOf(m);(P=>{var M=de(P,2);d(d()[b]=M[0],!0),n(M[1])})([n(),d()[b]]),E(v,!1)},Z=async()=>{try{await De({id:n().id,mergePersonDto:{ids:[i().id]}}),S.success(t()("merge_people_successfully")),e.onClose([i(),n()])}catch(m){C(m,t()("errors.unable_to_save_name"))}};$e(async()=>{await xe(),document.querySelector("#merge-confirm-button")?.focus()});{let m=l(()=>t()("merge_people")),b=l(()=>N),P=l(()=>t()("yes")),M=l(()=>t()("no"));ge(a,{get title(){return`${o(m)??""} - ${o(b)??""}`},submitColor:"primary",get submitText(){return o(P)},get cancelText(){return o(M)},get onClose(){return e.onClose},onSubmit:Z,children:(Q,_)=>{var x=Xe(),f=ee(x),H=s(f);{var re=h=>{var g=Qe(),w=ee(g),O=s(w);{let $=l(()=>X(i()));Y(O,{circle:!0,shadow:!0,get url(){return o($)},get altText(){return i().name},widthStyle:"100%"})}r(w);var B=u(w,2),D=u(s(B),2),T=s(D),j=s(T);ce(j,{get icon(){return Oe},size:"48",class:"rotate-90 dark:text-white"}),r(T),r(D);var k=u(D,2),A=s(k);{let $=l(()=>t()("swap_merge_direction"));Be(A,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return o($)},get icon(){return je},onclick:()=>(J=>{var ie=de(J,2);return i(ie[0]),n(ie[1]),J})([n(),i()])})}r(k),r(B);var p=u(B,2);p.__click=()=>{d().length>0&&E(v,!o(v))};var R=s(p);{let $=l(()=>d().length>0),J=l(()=>X(n()));Y(R,{get border(){return o($)},circle:!0,shadow:!0,get url(){return o(J)},get altText(){return n().name},widthStyle:"100%"})}r(p),z(()=>p.disabled=d().length===0),y(h,g)},G=h=>{var g=Ve(),w=s(g),O=s(w);O.__click=()=>E(v,!1);var B=s(O);ce(B,{get icon(){return Ae}}),r(O),r(w);var D=u(w,2),T=s(D);Me(T,21,d,j=>j.id,(j,k)=>{var A=Re(),p=s(A);p.__click=()=>te(o(k));var R=s(p);{let $=l(()=>X(o(k)));Y(R,{border:!0,circle:!0,shadow:!0,get url(){return o($)},get altText(){return o(k).name},widthStyle:"100%"})}r(p),r(A),y(j,A)}),r(T),r(D),r(g),z(()=>ze(T,1,`flex flex-wrap justify-center md:grid md:grid-cols-${d().length??""}`)),y(h,g)};me(H,h=>{o(v)?h(G,!1):h(re)})}r(f);var I=u(f,2),ae=s(I),pe=s(ae,!0);r(ae),r(I);var se=u(I,2),oe=s(se),ye=s(oe,!0);r(oe),r(se),z((h,g)=>{K(pe,h),K(ye,g)},[()=>t()("are_these_the_same_person"),()=>t()("they_will_be_merged_together")]),y(Q,x)},$$slots:{default:!0}})}ve(),F()}we(["click"]);export{ht as P,ft as g};
