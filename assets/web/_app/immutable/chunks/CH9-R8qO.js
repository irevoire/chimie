import{t as T}from"./C9pIfr-B.js";import{D as v,b as P}from"./Cx5lmlld.js";import"./DsnmJJEf.js";import{p as Y,g as d,u as _,a as q,h as B,f as G,c as l,r as p,s as b,j as J,t as C,d as k}from"./BOqQhZBJ.js";import{s as F}from"./BufZg4h2.js";import{f as Z,a as I}from"./CnteGC4G.js";import{s as K,d as Q,a as R}from"./B227BkWK.js";import{F as X}from"./BbGcRfD-.js";import{s as z,W as w}from"./Jagi0WJL.js";import{a3 as tt}from"./LrV5ZTyj.js";import{$ as M}from"./DdY9CyNE.js";import{C as et}from"./C20f7eOz.js";import{C as st}from"./BHgwLGQu.js";import{L as ot}from"./eLOR7anR.js";import"./C2I_EQjW.js";import{a6 as nt,a$ as at}from"./DeYUhNiz.js";import{t as rt,h as x}from"./D4fmOnVC.js";function it(e,t,s){return e===e&&(s!==void 0&&(e=e<=s?e:s),t!==void 0&&(e=e>=t?e:t)),e}function St(e,t,s){return s===void 0&&(s=t,t=void 0),s!==void 0&&(s=T(s),s=s===s?s:0),t!==void 0&&(t=T(t),t=t===t?t:0),it(T(e),t,s)}const ft=Intl.DateTimeFormat().resolvedOptions().timeZone,ct=Intl.supportedValuesOf("timeZone");function jt(e){return ct.map(t=>dt(t,e)).filter(t=>t.valid).sort((t,s)=>mt(t,s))}function S(e,t){const o=v.fromISO(t,{zone:e}).set({year:v.now().year}),n=o.setZone(e,{keepLocalTime:!0}).offset,a=o.setZone(e,{keepLocalTime:!0}).toFormat("ZZ");return{offsetMinutes:n,offsetFormat:a}}function dt(e,t){const{offsetMinutes:s,offsetFormat:o}=S(e,t),n=v.fromISO(t,{zone:e}),a=t.replace(/\.\d+/,""),i=/T\d{2}:\d{2}:\d{2}$/.test(a)?"yyyy-MM-dd'T'HH:mm:ss":"yyyy-MM-dd'T'HH:mm",m=a===n.toFormat(i),u=n.isValid&&m;return{value:e,offsetMinutes:s,label:e+" ("+o+")"+(u?"":" [invalid date!]"),valid:u}}function mt(e,t){const s=e.offsetMinutes-t.offsetMinutes;return s!=0?s:e.value.localeCompare(t.value,void 0,{sensitivity:"base"})}function Ht(e,t,s,o){const n=e.offset,a=s.find(r=>r.value===o?.value),c=s.find(r=>r.value===t),i=s.find(r=>r.offsetMinutes===n&&r.value===ft),m=s.find(r=>r.offsetMinutes===n);return a??c??i??m??{label:"UTC (+00:00)",offsetMinutes:0,value:"UTC",valid:!0}}function ut(e,t){const s=v.fromISO(e,{zone:"utc"}),{offsetMinutes:o}=S(t.value,e),n=`UTC${o>=0?"+":""}${P.fromObject({minutes:o}).toFormat("hh:mm")}`;return v.fromObject(s.toObject(),{zone:n})}function Lt(e,t){return ut(e,t).toISO({includeOffset:!0})}var lt=Z("<b> </b>"),pt=Z('<p><!></p> <p><b> </b></p> <div class="pt-4 flex justify-center items-center gap-2"><!> <!></div>',1);function Ut(e,t){Y(t,!0);const s=()=>R(M,"$t",o),[o,n]=K();let a=B(!1);const c=i=>{i&&d(a)&&Q(z,!1),t.onClose(i)};{const i=r=>{var O=pt(),h=G(O),j=l(h);{const f=(V,W)=>{let E=()=>W?.().message;var g=lt(),N=l(g,!0);p(g),C(()=>F(N,E())),I(V,g)};let U=_(()=>({count:t.size}));X(j,{key:"permanently_delete_assets_prompt",get values(){return d(U)},children:f,$$slots:{default:!0}})}p(h);var y=b(h,2),$=l(y),H=l($,!0);p($),p(y);var A=b(y,2),D=l(A);st(D,{id:"confirm-deletion-input",color:"secondary",get checked(){return d(a)},set checked(f){J(a,f,!0)}});var L=b(D,2);{let f=_(()=>s()("do_not_show_again"));ot(L,{get label(){return d(f)},for:"confirm-deletion-input"})}p(A),C(f=>F(H,f),[()=>s()("cannot_undo_this_action")]),I(r,O)};let m=_(()=>s()("permanently_delete_assets_count",{values:{count:t.size}})),u=_(()=>s()("delete"));et(e,{get title(){return d(m)},get confirmText(){return d(u)},get icon(){return tt},onClose:c,prompt:i,$$slots:{prompt:!0}})}q(),n()}const Vt=async(e,t,s,o=void 0)=>{const n=k(M);try{const a=s.map(c=>c.id);await nt({assetBulkDeleteDto:{ids:a,force:e}}),t(a),rt.custom({component:w,props:{title:n("success"),description:e?n("assets_permanently_deleted_count",{values:{count:a.length}}):n("assets_trashed_count",{values:{count:a.length}}),color:"success",button:o&&!e?{color:"secondary",text:n("undo"),onClick:()=>vt(o,s)}:void 0}},{timeout:5e3})}catch(a){x(a,n("errors.unable_to_delete_assets"))}},vt=async(e,t)=>{const s=k(M);try{const o=t.map(n=>n.id);await at({bulkIdsDto:{ids:o}}),e?.(t)}catch(o){x(o,s("errors.unable_to_restore_assets"))}};function Wt(e,{stack:t,toDeleteIds:s}){t!=null&&(e.update([t.primaryAssetId],o=>o.stack={id:t.id,primaryAssetId:t.primaryAssetId,assetCount:t.assets.length}),e.removeAssets(s))}function Et(e,t){e.update(t.map(s=>s.id),s=>(s.stack=null,{remove:!1})),e.upsertAssets(t)}export{Ut as A,jt as a,Wt as b,St as c,Vt as d,ut as e,Ht as g,Lt as t,Et as u};
