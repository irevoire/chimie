import{$ as w,a0 as b,D as g,a1 as S}from"./Jagi0WJL.js";import{a as _,i as v}from"./BIB7ntQe.js";import{aZ as M,d as F,u as o,g as n,j as l,h as f,i as T}from"./BOqQhZBJ.js";import{u as W}from"./Cx5lmlld.js";import{A as L}from"./DeYUhNiz.js";import{S as C}from"./De1sTUmb.js";import{bz as G}from"./LrV5ZTyj.js";import{c as O}from"./BufZg4h2.js";function x(t){let e;const s=O(r=>{let u=!1;const d=t.subscribe(c=>{e=c,u&&r()});return u=!0,d});function i(){return M()?(s(),e):F(t)}return"set"in t?{get current(){return i()},set current(r){t.set(r)}}:{get current(){return i()}}}let a,h=null;function A(){return(h===null||h.byteLength===0)&&(h=new Float32Array(a.memory.buffer)),h}let y=0;function H(t,e){const s=e(t.length*4,4)>>>0;return A().set(t,s/4),y=t.length,s}function j(t,e){return t=t>>>0,A().subarray(t/4,t/4+e)}function U(t,e,s,i,r){const u=H(t,a.__wbindgen_malloc),d=y,c=a.get_justified_layout(u,d,e,s,i,r);var m=j(c[0],c[1]).slice();return a.__wbindgen_free(c[0],c[1]*4,4),m}function R(){const t={};return t.wbg={},t.wbg.__wbindgen_init_externref_table=function(){const e=a.__wbindgen_export_0,s=e.grow(4);e.set(0,void 0),e.set(s+0,void 0),e.set(s+1,null),e.set(s+2,!0),e.set(s+3,!1)},t}function E(t,e){return a=t.exports,h=null,a.__wbindgen_start(),a}function I(t){if(a!==void 0)return a;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module:t}=t:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const e=R();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));const s=new WebAssembly.Instance(t,e);return E(s)}class p{constructor(e,{rowHeight:s,rowWidth:i,spacing:r,heightTolerance:u}){I(w),e.length===0?this.layout=new Float32Array(4):this.layout=U(e,s,i,r,u)}get containerWidth(){return this.layout[0]}get containerHeight(){return this.layout[1]}getTop(e){return this.layout[e*4+4]}getLeft(e){return this.layout[e*4+5]}getWidth(e){return this.layout[e*4+6]}getHeight(e){return this.layout[e*4+7]}getPosition(e){return{top:this.layout[e*4+4],left:this.layout[e*4+5],width:this.layout[e*4+6],height:this.layout[e*4+7]}}}const P=b.LAYOUT.WASM;function Q(t,e){return P?_(t)?z(t,e):D(t,e):k(t,e)}function z(t,e){const s=new Float32Array(t.length);for(let i=0;i<t.length;i++)s[i]=t[i].ratio;return new p(s,e)}function D(t,e){const s=new Float32Array(t.length);for(let i=0;i<t.length;i++)s[i]=g(t[i])??1;return new p(s,e)}class J{result;width;constructor(e){this.result=e,this.width=0;for(const s of this.result.boxes)if(s.top===0)this.width=s.left+s.width;else break}get containerWidth(){return this.width}get containerHeight(){return this.result.containerHeight}getTop(e){return this.result.boxes[e]?.top}getLeft(e){return this.result.boxes[e]?.left}getWidth(e){return this.result.boxes[e]?.width}getHeight(e){return this.result.boxes[e]?.height}getPosition(e){const s=this.result.boxes[e];return{top:s.top,left:s.left,width:s.width,height:s.height}}}function k(t,e){const s={targetRowHeight:e.rowHeight,containerWidth:e.rowWidth,boxSpacing:e.spacing,targetRowHeightTolerange:e.heightTolerance,containerPadding:0},i=S(t.map(r=>v(r)?r.ratio:g(r)??1),s);return new J(i)}class X{selectedAssetsMap=new G;#e=o(()=>Array.from(this.selectedAssetsMap.values()));get selectedAssets(){return n(this.#e)}set selectedAssets(e){l(this.#e,e)}#t=f(!1);get selectAll(){return n(this.#t)}set selectAll(e){l(this.#t,e,!0)}hasSelectedAsset(e){return this.selectedAssetsMap.has(e)}selectedGroup=new C;#s=f(T([]));get assetSelectionCandidates(){return n(this.#s)}set assetSelectionCandidates(e){l(this.#s,e,!0)}hasSelectionCandidate(e){return this.assetSelectionCandidates.some(s=>s.id===e)}#i=f(null);get assetSelectionStart(){return n(this.#i)}set assetSelectionStart(e){l(this.#i,e,!0)}#r=o(()=>this.selectedAssetsMap.size>0);get selectionActive(){return n(this.#r)}set selectionActive(e){l(this.#r,e)}user=x(W);#n=o(()=>this.user.current?.id);get userId(){return n(this.#n)}set userId(e){l(this.#n,e)}#l=o(()=>this.selectedAssets.every(e=>e.isTrashed));get isAllTrashed(){return n(this.#l)}set isAllTrashed(e){l(this.#l,e)}#a=o(()=>this.selectedAssets.every(e=>e.visibility===L.Archive));get isAllArchived(){return n(this.#a)}set isAllArchived(e){l(this.#a,e)}#o=o(()=>this.selectedAssets.every(e=>e.isFavorite));get isAllFavorite(){return n(this.#o)}set isAllFavorite(e){l(this.#o,e)}#u=o(()=>this.selectedAssets.every(e=>e.ownerId===this.userId));get isAllUserOwned(){return n(this.#u)}set isAllUserOwned(e){l(this.#u,e)}selectAsset(e){this.selectedAssetsMap.set(e.id,e)}selectAssets(e){for(const s of e)this.selectAsset(s)}removeAssetFromMultiselectGroup(e){this.selectedAssetsMap.delete(e)}addGroupToMultiselectGroup(e){this.selectedGroup.add(e)}removeGroupFromMultiselectGroup(e){this.selectedGroup.delete(e)}setAssetSelectionStart(e){this.assetSelectionStart=e}setAssetSelectionCandidates(e){this.assetSelectionCandidates=e}clearAssetSelectionCandidates(){this.assetSelectionCandidates=[]}clearMultiselect(){this.selectAll=!1,this.selectedAssetsMap.clear(),this.selectedGroup.clear(),this.assetSelectionCandidates=[],this.assetSelectionStart=null}}export{X as A,Q as g};
