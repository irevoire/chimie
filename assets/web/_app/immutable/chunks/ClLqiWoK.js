import{W as F,h as I,g as x,j as S,p as N,b as P,c as _,e as V,t as W,a as z,r as D,u as H}from"./BOqQhZBJ.js";import{s as j}from"./_U16pX41.js";import"./DsnmJJEf.js";import{f as G,s as T,a as U}from"./CnteGC4G.js";import{G as J,aa as L,s as C,bB as K}from"./LrV5ZTyj.js";import{a as Q}from"./4T_x9N89.js";import{b as X}from"./9i_j0jQI.js";import{p as s,c as Y}from"./B227BkWK.js";import{c as Z}from"./BmZTbFl5.js";import{l as $}from"./BNLYq5HQ.js";import{e as A}from"./ytu5q_IM.js";import{k as tt}from"./Jagi0WJL.js";import{q as et}from"./Ze2c3aZz.js";const wt=(e,t="middle")=>{const{currentTarget:o,target:d}=e,u="x"in e?e.x:0,y="y"in e?e.y:0,h=(o||d)?.getBoundingClientRect();return h?nt(h,t):{x:u,y}},nt=(e,t="middle")=>{switch(t){case"middle":return{x:e.x+e.width/2,y:e.y+e.height/2};case"top-left":return{x:e.x,y:e.y};case"top-right":return{x:e.x+e.width,y:e.y};case"bottom-left":return{x:e.x,y:e.y+e.height};case"bottom-right":return{x:e.x+e.width,y:e.y+e.height}}},bt=(e,t)=>{const o=()=>{const{container:n,selectedId:i}=t;return n?.querySelector(`#${i}`)},d=()=>{const{closeDropdown:n,selectionChanged:i}=t;i(void 0),n()},u=async(n,i)=>{const{selectionChanged:l,container:g,openDropdown:p}=t;if(p&&(p(i),await F()),!g)return;const m=Array.from(g.children).filter(v=>v.tagName!=="HR");if(m.length===0)return;const f=o(),w=f?m.indexOf(f):-1,c=(n==="up"?-1:1)+(n==="up"&&w===-1?1:0),b=(w+c+m.length)%m.length,a=m[b];a?.scrollIntoView({block:"nearest"}),l(a?.id)},y=n=>{const{onEscape:i}=t;if(i){i(n);return}n.stopPropagation(),d()},h=n=>{const{selectedId:i,isOpen:l,closeDropdown:g}=t;if(l&&!i){g();return}if(!i){u("down",n);return}o()?.click()},{destroy:k}=j(e,[{shortcut:{key:"ArrowUp"},onShortcut:n=>u("up",n)},{shortcut:{key:"ArrowDown"},onShortcut:n=>u("down",n)},{shortcut:{key:"Escape"},onShortcut:n=>y(n),preventDefault:!1},{shortcut:{key:" "},onShortcut:n=>h(n)},{shortcut:{key:"Enter"},onShortcut:n=>h(n)}]);return{update(n){t=n},destroy:k}};class it{constructor(){A.on({AppInit:()=>tt.subscribe(t=>this.setLanguage(t))})}#t=I(!1);get rtl(){return x(this.#t)}set rtl(t){S(this.#t,t,!0)}setLanguage(t){const o=$.find(d=>d.code===t);o&&(this.rtl=o.rtl??!1,document.body.setAttribute("dir",o.rtl?"rtl":"ltr"),A.emit("LanguageChange",o))}}const ot=new it;var at=G('<div class="fixed min-w-50 w-max max-w-75 overflow-hidden rounded-lg shadow-lg z-1 immich-scrollbar"><ul class="flex flex-col transition-all duration-250 ease-in-out outline-none overflow-auto immich-scrollbar" role="menu" tabindex="-1"><!></ul></div>');function vt(e,t){N(t,!0);let o=s(t,"isVisible",3,!1),d=s(t,"direction",3,"right"),u=s(t,"x",3,0),y=s(t,"y",3,0),h=s(t,"id",3,void 0),k=s(t,"ariaLabel",3,void 0),n=s(t,"ariaLabelledBy",3,void 0),i=s(t,"ariaActiveDescendant",3,void 0),l=s(t,"menuElement",15),g=s(t,"onClose",3,void 0);const p=r=>r==="left"?"right":"left",m=H(()=>ot.rtl?p(d()):d()),f=H(()=>{if(!l())return{left:0,top:0};const r=l().getBoundingClientRect(),E=x(m)==="left"?r.width:0,O=Math.min(l().clientHeight,x(w))||0,R=Math.max(8,Math.min(window.innerWidth-r.width,u()-E)),M=Math.max(8,Math.min(window.innerHeight-O,y())),q=window.innerHeight-M-8;return{left:R,top:M,maxHeight:q}});let w=I(0);var c=at();let b;var a=_(c);let v;var B=_(a);T(B,()=>t.children??P),D(a),Y(a,r=>l(r),()=>l()),D(c),V(()=>X(c,"clientHeight",r=>S(w,r))),Q(c,(r,E)=>Z?.(r,E),()=>({onOutclick:g()})),W(()=>{b=L(c,"",b,{left:`${x(f).left??""}px`,top:`${x(f).top??""}px`}),C(a,"id",h()),C(a,"aria-activedescendant",i()??""),C(a,"aria-label",k()),C(a,"aria-labelledby",n()),v=L(a,"",v,{"max-height":o()?`${x(f).maxHeight}px`:"0px"})}),J(3,c,()=>K,()=>({duration:250,easing:et})),U(e,c),z()}export{vt as C,wt as a,bt as c,nt as g,ot as l};
