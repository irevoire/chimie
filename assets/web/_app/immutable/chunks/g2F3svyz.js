import{e as Z}from"./ytu5q_IM.js";import"./DsnmJJEf.js";import{p as U,c as D,g as s,u as m,s as $,r as K,a as L,i as B,f as O,j as T,h as F,at as me,n as J,t as N}from"./BOqQhZBJ.js";import{f as S,a as y,c as ge,t as Q}from"./CnteGC4G.js";import{p as ne,s as W,a as H}from"./B227BkWK.js";import{i as fe}from"./QS5y7wlf.js";import{e as oe,t as z,h as ee}from"./D4fmOnVC.js";import{bb as b,bc as ve,bd as _e,be as pe}from"./DeYUhNiz.js";import{C as Y}from"./BHgwLGQu.js";import{L as V}from"./eLOR7anR.js";import{I as he,x as ye,T as be,B as ae,d2 as te,V as $e,bm as ke,ae as Ae}from"./LrV5ZTyj.js";import{$ as E,g as se}from"./DdY9CyNE.js";import{I as re}from"./BJT5MMCK.js";import{s as X}from"./BufZg4h2.js";import{c as Ce}from"./Jagi0WJL.js";import{M as Ie,a as Pe,b as xe,H as we,m as R}from"./C20f7eOz.js";import{T as Ke}from"./BXaFREg4.js";import{F as le}from"./C0Ca_l_S.js";import{F as ie}from"./DzmAA-7p.js";var Se=S('<div class="flex items-center gap-2"><!> <!></div>'),Me=S('<div class="border bg-subtle dark:bg-black/30 dark:border-black p-4 rounded-2xl"><div class="flex items-center gap-2"><!> <!></div> <div class="mx-6 mt-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2"></div></div>');function De(n,e){U(e,!0);let t=m(()=>e.subItems.filter(a=>e.selectedItems.includes(a)).length===e.subItems.length);const l=()=>{s(t)?e.handleDeselectItems(e.subItems):e.handleSelectItems(e.subItems)},P=a=>{e.selectedItems.includes(a)?e.handleDeselectItems([a]):e.handleSelectItems([a])};var o=Me(),i=D(o),u=D(i);Y(u,{get id(){return`permission-${e.title??""}`},size:"tiny",get checked(){return s(t)},onCheckedChange:l});var k=$(u,2);V(k,{get label(){return e.title},get for(){return`permission-${e.title??""}`},class:"font-mono text-primary text-lg"}),K(i);var v=$(i,2);oe(v,20,()=>e.subItems,a=>a,(a,g)=>{var A=Se(),_=D(A);{let p=m(()=>e.selectedItems.includes(g));Y(_,{get id(){return`permission-${g??""}`},size:"tiny",get checked(){return s(p)},onCheckedChange:()=>P(g)})}var c=$(_,2);V(c,{get label(){return g},get for(){return`permission-${g??""}`},class:"text-sm font-mono"}),K(A),y(a,A)}),K(v),K(o),y(n,o),L()}var Oe=S('<!> <div class="flex items-center gap-2 m-4" id="permission-container"><!> <!></div> <div class="ms-4 flex flex-col gap-2"><!> <!></div>',1);function ce(n,e){U(e,!0);const t=()=>H(E,"$t",l),[l,P]=W();let o=ne(e,"selectedPermissions",31,()=>B([]));const i={};for(const r of Object.values(b)){if(r===b.All)continue;const[f]=r.split(".");i[f]||(i[f]=[]),i[f].push(r)}let u=F(""),k=m(()=>o().length===Object.keys(b).length-1);const v=r=>(r=r.toLowerCase(),([f,w])=>f.toLowerCase().includes(r)||w.some(j=>j.toLowerCase().includes(r))),a=r=>{o(r?Object.values(b).filter(f=>f!==b.All):[])},g=m(()=>Object.entries(i).filter(v(s(u)))),A=r=>o(Array.from(new Set([...o(),...r]))),_=r=>o(o().filter(f=>!r.includes(f)));var c=Oe(),p=O(c);{let r=m(()=>t()("permission"));V(p,{get label(){return s(r)},for:"permission-container"})}var h=$(p,2),d=D(h);Y(d,{id:"input-select-all",size:"tiny",get checked(){return s(k)},onCheckedChange:a});var x=$(d,2);{let r=m(()=>t()("select_all"));V(x,{get label(){return s(r)},for:"input-select-all"})}K(h);var C=$(h,2),I=D(C);{const r=w=>{var j=ge(),q=O(j);{var de=G=>{{let ue=m(()=>t()("clear"));he(G,{get icon(){return ye},size:"small",variant:"ghost",shape:"round",color:"secondary",class:"me-1",onclick:()=>T(u,""),get"aria-label"(){return s(ue)}})}};fe(q,G=>{s(u)&&G(de)})}y(w,j)};let f=m(()=>t()("search"));re(I,{get placeholder(){return s(f)},get value(){return s(u)},set value(w){T(u,w,!0)},trailingIcon:r,$$slots:{trailingIcon:!0}})}var M=$(I,2);oe(M,17,()=>s(g),([r,f])=>r,(r,f)=>{var w=m(()=>me(s(f),2));let j=()=>s(w)[0],q=()=>s(w)[1];De(r,{get title(){return j()},get subItems(){return q()},get selectedItems(){return o()},handleSelectItems:A,handleDeselectItems:_})}),K(C),y(n,c),L(),P()}var je=S("<!> <!>",1),ze=S("<!> <!>",1),Te=S("<!> <!>",1);function Fe(n,e){U(e,!0);const t=()=>H(E,"$t",l),[l,P]=W();let o=ne(e,"secret",7,"");{let i=m(()=>t()("api_key"));Ie(n,{get title(){return s(i)},get icon(){return te},get onClose(){return e.onClose},size:"small",children:(u,k)=>{var v=Te(),a=O(v);Pe(a,{children:(A,_)=>{var c=je(),p=O(c);be(p,{size:"small",class:"mb-4",children:(d,x)=>{J();var C=Q();N(I=>X(C,I),[()=>t()("api_key_description")]),y(d,C)},$$slots:{default:!0}});var h=$(p,2);Ke(h,{readonly:!0,class:"font-mono",get value(){return o()},set value(d){o(d)}}),y(A,c)},$$slots:{default:!0}});var g=$(a,2);xe(g,{children:(A,_)=>{we(A,{fullWidth:!0,children:(c,p)=>{var h=ze(),d=O(h);ae(d,{shape:"round",onclick:()=>Ce(o()),fullWidth:!0,children:(C,I)=>{J();var M=Q();N(r=>X(M,r),[()=>t()("copy_to_clipboard")]),y(C,M)},$$slots:{default:!0}});var x=$(d,2);ae(x,{shape:"round",get onclick(){return e.onClose},fullWidth:!0,children:(C,I)=>{J();var M=Q();N(r=>X(M,r),[()=>t()("done")]),y(C,M)},$$slots:{default:!0}}),y(c,h)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(u,v)},$$slots:{default:!0}})}L(),P()}var Ue=S('<div class="mb-4 flex flex-col gap-2"><!></div> <!>',1);function Le(n,e){U(e,!0);const t=()=>H(E,"$t",l),[l,P]=W();let o=F("API Key"),i=F(B([]));const u=m(()=>s(i).length===Object.keys(b).length-1),k=async()=>{const v=s(u)?[b.All]:s(i),a=await We({name:s(o),permissions:v});a&&(await R.show(Fe,{secret:a.secret}),e.onClose())};{let v=m(()=>t()("new_api_key")),a=m(()=>t()("create"));le(n,{get title(){return s(v)},get icon(){return te},get onClose(){return e.onClose},onSubmit:k,get submitText(){return s(a)},size:"giant",children:(g,A)=>{var _=Ue(),c=O(_),p=D(c);{let d=m(()=>t()("name"));ie(p,{get label(){return s(d)},children:(x,C)=>{re(x,{get value(){return s(o)},set value(I){T(o,I,!0)}})},$$slots:{default:!0}})}K(c);var h=$(c,2);ce(h,{get selectedPermissions(){return s(i)},set selectedPermissions(d){T(i,d,!0)}}),y(g,_)},$$slots:{default:!0}})}L(),P()}var Be=S('<div class="mb-4 flex flex-col gap-2"><!></div> <!>',1);function Ve(n,e){U(e,!0);const t=()=>H(E,"$t",l),[l,P]=W(),o=a=>a.length===Object.keys(b).length-1,i=a=>a.includes(b.All)?Object.values(b).filter(g=>g!==b.All):a;let u=F(B(e.apiKey.name)),k=F(B(i(e.apiKey.permissions)));const v=async()=>{await He(e.apiKey,{name:s(u),permissions:o(s(k))?[b.All]:s(k)})&&e.onClose()};{let a=m(()=>t()("api_key"));le(n,{get title(){return s(a)},get icon(){return te},get onClose(){return e.onClose},onSubmit:v,size:"giant",children:(g,A)=>{var _=Be(),c=O(_),p=D(c);{let d=m(()=>t()("name"));ie(p,{get label(){return s(d)},children:(x,C)=>{re(x,{get value(){return s(u)},set value(I){T(u,I,!0)}})},$$slots:{default:!0}})}K(c);var h=$(c,2);ce(h,{get selectedPermissions(){return s(k)},set selectedPermissions(d){T(k,d,!0)}}),y(g,_)},$$slots:{default:!0}})}L(),P()}const dt=n=>({Create:{title:n("new_api_key"),icon:Ae,onAction:()=>R.show(Le,{})}}),ut=(n,e)=>{const t={title:n("edit_key"),icon:ke,onAction:()=>R.show(Ve,{apiKey:e})},l={title:n("delete_key"),icon:$e,onAction:()=>Ee(e)};return{Update:t,Delete:l}},We=async n=>{const e=await se();try{if(!n.name){z.warning(e("api_key_empty"));return}if(n.permissions.length===0){z.warning(e("permission_empty"));return}const t=await ve({apiKeyCreateDto:n});return Z.emit("ApiKeyCreate",t.apiKey),t}catch(t){ee(t,e("errors.unable_to_create_api_key"))}},He=async(n,e)=>{const t=await se();if(!e.name){z.warning(t("api_key_empty"));return}if(e.permissions&&e.permissions.length===0){z.warning(t("permission_empty"));return}try{const l=await pe({id:n.id,apiKeyUpdateDto:e});return Z.emit("ApiKeyUpdate",l),z.success(t("saved_api_key")),!0}catch(l){ee(l,t("errors.unable_to_save_api_key"))}},Ee=async n=>{const e=await se();if(await R.showDialog({prompt:e("delete_api_key_prompt")}))try{await _e({id:n.id}),Z.emit("ApiKeyDelete",n),z.success(e("removed_api_key",{values:{name:n.name}}))}catch(l){ee(l,e("errors.unable_to_remove_api_key"))}};export{dt as a,ut as g,We as h};
