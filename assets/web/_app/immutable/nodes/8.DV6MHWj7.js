import{a as yt,r as Lt}from"../chunks/Cx5lmlld.js";import{g as Ut,$ as Ct}from"../chunks/DdY9CyNE.js";import{p as At,q as St,t as ut,v as Tt,w as kt}from"../chunks/DeYUhNiz.js";import"../chunks/DsnmJJEf.js";import{p as jt,h as Dt,i as J,f as E,g as t,u as o,s as n,a as Et,j as Ot,c as zt,b as Bt,t as f,n as p,r as It}from"../chunks/BOqQhZBJ.js";import{s as g}from"../chunks/BufZg4h2.js";import{f as O,s as Mt,a as s,t as v,c as Rt}from"../chunks/CnteGC4G.js";import{i as qt}from"../chunks/QS5y7wlf.js";import{e as Ft}from"../chunks/D4fmOnVC.js";import{G as Ht,ab as Wt,ac as Gt}from"../chunks/LrV5ZTyj.js";import{s as Jt,a as it}from"../chunks/B227BkWK.js";import{g as ct}from"../chunks/C4XZXykC.js";import{A as Kt}from"../chunks/4in-FAdc.js";import{O as Nt}from"../chunks/Di6OVBka.js";import{E as Qt}from"../chunks/0tdQcI5E.js";import{R}from"../chunks/BeWG-__C.js";import{g as Vt,a as Xt}from"../chunks/pgDeqfeq.js";import{o as Yt,l as Zt}from"../chunks/Jagi0WJL.js";import{C as te}from"../chunks/BCL4P6ef.js";import{C as ee}from"../chunks/WscBzvwE.js";import{T as re,a as se,b as U,c as ae,d as oe,e as C}from"../chunks/Bn2SVuxV.js";import{L as dt}from"../chunks/Dj0AsE1j.js";import{C as le}from"../chunks/BPix1jPq.js";const ne=(async({url:q})=>{await yt(q,{admin:!0}),await Lt();const w=await At({withDeleted:!1}),i=await Ut(),x=await St(),z=await Promise.all(x.map(async({id:c})=>[c,await ut({id:c})])),F=await Promise.all(x.map(async({id:c,ownerId:A})=>[c,await Tt({id:A})]));return{allUsers:w,libraries:x,statistics:Object.fromEntries(z),owners:Object.fromEntries(F),meta:{title:i("external_libraries")}}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,load:ne},Symbol.toStringTag,{value:"Module"}));var ie=O("<!> <!> <!> <!> <!> <!>",1),ce=O("<!> <!> <!> <!> <!> <!>",1),de=O("<!> <!>",1),ue=O('<div class="flex flex-col items-center gap-2"><!> <!></div>'),me=O("<!> <!> <!>",1);function Me(q,w){jt(w,!0);const i=()=>it(Ct,"$t",z),x=()=>it(Zt,"$locale",z),[z,F]=Jt();let c=Dt(J(w.data.libraries)),A=J(w.data.statistics),K=J(w.data.owners);const mt=async r=>{await ct(R.viewLibrary(r))},$t=async r=>{const $=t(c).findIndex(({id:S})=>S===r.id);$!==-1&&(t(c)[$]=await kt({id:r.id}),A[r.id]=await ut({id:r.id}))},ft=({id:r})=>{Ot(c,t(c).filter($=>$.id!==r),!0),delete A[r],delete K[r]},N=o(()=>Xt(i(),t(c))),Q=o(()=>t(N).Create),V=o(()=>t(N).ScanAll),pt=r=>{const{Detail:$,Scan:S,Edit:tt,Delete:H}=Vt(i(),r);return[$,S,tt,Gt.Divider,H]},d={column1:"w-4/12",column2:"w-4/12",column3:"w-1/12",column4:"w-1/12",column5:"w-1/12",column6:"w-1/12 flex justify-end"};var X=me(),Y=E(X);Nt(Y,{onLibraryCreate:mt,onLibraryUpdate:$t,onLibraryDelete:ft});var Z=n(Y,2);{let r=o(()=>i()("library")),$=o(()=>[t(Q),t(V)]);te(Z,{get name(){return t(r)},get actions(){return t($)}})}var gt=n(Z,2);{let r=o(()=>[{title:w.data.meta.title}]),$=o(()=>[t(V),t(Q)]);Kt(gt,{get breadcrumbs(){return t(r)},get actions(){return t($)},children:(S,tt)=>{ee(S,{size:"large",center:!0,class:"my-4",children:(H,$e)=>{var B=ue(),et=zt(B);{var vt=y=>{re(y,{striped:!0,size:"small",spacing:"small",children:(W,fe)=>{var rt=de(),st=E(rt);se(st,{children:(G,bt)=>{var T=ie(),I=E(T);U(I,{get class(){return d.column1},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("name")]),s(a,e)},$$slots:{default:!0}});var P=n(I,2);U(P,{get class(){return d.column2},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("owner")]),s(a,e)},$$slots:{default:!0}});var b=n(P,2);U(b,{get class(){return d.column3},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("photos")]),s(a,e)},$$slots:{default:!0}});var L=n(b,2);U(L,{get class(){return d.column4},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("videos")]),s(a,e)},$$slots:{default:!0}});var k=n(L,2);U(k,{get class(){return d.column5},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("size")]),s(a,e)},$$slots:{default:!0}});var M=n(k,2);U(M,{get class(){return d.column6}}),s(G,T)},$$slots:{default:!0}});var wt=n(st,2);ae(wt,{children:(G,bt)=>{var T=Rt(),I=E(T);Ft(I,17,()=>t(c),P=>P.id+P.name,(P,b)=>{const L=o(()=>{const{photos:a,usage:_,videos:e}=A[t(b).id];return{photos:a,usage:_,videos:e}}),k=o(()=>{const[a,_]=Yt(t(L).usage,0);return{diskUsage:a,diskUsageUnit:_}}),M=o(()=>K[t(b).id]);oe(P,{children:(a,_)=>{var e=ce(),u=E(e);C(u,{get class(){return d.column1},children:(m,j)=>{{let l=o(()=>R.viewLibrary(t(b)));dt(m,{get href(){return t(l)},children:(h,xt)=>{p();var D=v();f(()=>g(D,t(b).name)),s(h,D)},$$slots:{default:!0}})}},$$slots:{default:!0}});var at=n(u,2);C(at,{get class(){return d.column2},children:(m,j)=>{{let l=o(()=>R.viewUser(t(M)));dt(m,{get href(){return t(l)},children:(h,xt)=>{p();var D=v();f(()=>g(D,t(M).name)),s(h,D)},$$slots:{default:!0}})}},$$slots:{default:!0}});var ot=n(at,2);C(ot,{get class(){return d.column3},children:(m,j)=>{p();var l=v();f(h=>g(l,h),[()=>t(L).photos.toLocaleString(x())]),s(m,l)},$$slots:{default:!0}});var lt=n(ot,2);C(lt,{get class(){return d.column4},children:(m,j)=>{p();var l=v();f(h=>g(l,h),[()=>t(L).videos.toLocaleString(x())]),s(m,l)},$$slots:{default:!0}});var nt=n(lt,2);C(nt,{get class(){return d.column5},children:(m,j)=>{p();var l=v();f(()=>g(l,`${t(k).diskUsage??""} ${t(k).diskUsageUnit??""}`)),s(m,l)},$$slots:{default:!0}});var Pt=n(nt,2);C(Pt,{get class(){return d.column6},children:(m,j)=>{{let l=o(()=>i()("open")),h=o(()=>pt(t(b)));le(m,{color:"primary",get"aria-label"(){return t(l)},get items(){return t(h)}})}},$$slots:{default:!0}}),s(a,e)},$$slots:{default:!0}})}),s(G,T)},$$slots:{default:!0}}),s(W,rt)},$$slots:{default:!0}})},_t=y=>{{let W=o(()=>i()("no_libraries_message"));Qt(y,{fullWidth:!0,get text(){return t(W)},onClick:()=>ct(R.newLibrary()),class:"mt-10 mx-auto"})}};qt(et,y=>{t(c).length>0?y(vt):y(_t,!1)})}var ht=n(et,2);Mt(ht,()=>w.children??Bt),It(B),Ht(1,B,()=>Wt,()=>({duration:500})),s(H,B)},$$slots:{default:!0}})},$$slots:{default:!0}})}s(q,X),Et(),F()}export{Me as component,Ie as universal};
