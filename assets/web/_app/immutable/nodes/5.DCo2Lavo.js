import{a as xe,D as ue}from"../chunks/Cx5lmlld.js";import{g as be,$ as oe}from"../chunks/DdY9CyNE.js";import"../chunks/DsnmJJEf.js";import{s as D,a as ke}from"../chunks/BufZg4h2.js";import{p as ne,c as y,r as h,a as de,g as e,u as r,f as J,s as p,t as O,n as ie,h as ye,i as Le,j as me,b as we}from"../chunks/BOqQhZBJ.js";import{i as K}from"../chunks/QS5y7wlf.js";import{e as _e,i as Se}from"../chunks/D4fmOnVC.js";import{f as C,a,c as fe,t as z,s as Ae}from"../chunks/CnteGC4G.js";import{p as he,s as ce,a as ae}from"../chunks/B227BkWK.js";import{g as Ce}from"../chunks/C4XZXykC.js";import{p as $e}from"../chunks/DbKlvrsB.js";import{U as Pe}from"../chunks/CwTmTzRk.js";import{O as Te}from"../chunks/Di6OVBka.js";import{ar as ze,h as De,T as ee,ac as Oe}from"../chunks/LrV5ZTyj.js";import{A as le}from"../chunks/Bp2HQ4kn.js";import{A as je,a as Me,N as Ue}from"../chunks/BUBQrRQ7.js";import{t as Ee,l as Ie}from"../chunks/Jagi0WJL.js";import{R as ge}from"../chunks/BeWG-__C.js";import{b as Ne}from"../chunks/CaDSsDA9.js";import{S as re,g as Re}from"../chunks/DeYUhNiz.js";import{C as We}from"../chunks/BPix1jPq.js";import{G as Be}from"../chunks/BhyZz3VN.js";import{C as Ge}from"../chunks/WscBzvwE.js";const Fe=(async({url:j})=>(await xe(j),{meta:{title:(await be())("shared_links")}})),St=Object.freeze(Object.defineProperty({__proto__:null,load:Fe},Symbol.toStringTag,{value:"Module"}));var qe=C('<div class="relative shrink-0 size-22"><!></div>');function He(j,t){ne(t,!0);const x=()=>ae(oe,"$t",l),[l,I]=ce();let v=he(t,"preload",3,!1),$=he(t,"class",3,"");var _=qe(),L=y(_);{var Q=o=>{je(o,{get album(){return t.sharedLink.album},get class(){return $()},get preload(){return v()}})},M=o=>{{let P=r(()=>x()("individual_share")),N=r(()=>Ee({id:t.sharedLink.assets[0].id}));Me(o,{get alt(){return e(P)},get class(){return $()},get preload(){return v()},get src(){return e(N)}})}},w=o=>{{let P=r(()=>x()("unnamed_share"));Ue(o,{get alt(){return e(P)},get class(){return $()},get preload(){return v()}})}};K(L,o=>{t.sharedLink?.album?o(Q):t.sharedLink.assets[0]?o(M,1):o(w,!1)})}h(_),a(j,_),de(),I()}var Je=C("<!> <!>",1),Ke=C('<!> <div class="flex flex-col gap-4 justify-between"><div class="flex flex-col"><!> <!> <!></div> <div class="flex flex-wrap items-center gap-2"></div></div>',1),Qe=C('<div class="flex w-full border-b border-gray-200 transition-all hover:border-immich-primary dark:border-gray-600 dark:text-immich-gray dark:hover:border-immich-dark-primary"><!> <div class="flex flex-auto flex-col place-content-center place-items-end text-end ms-4"><div class="sm:flex hidden"><!> <!> <!></div> <div class="sm:hidden"><!></div></div></div>');function Ve(j,t){ne(t,!0);const x=()=>ae(Ie,"$locale",I),l=()=>ae(oe,"$t",I),[I,v]=ce();let $=ue.now(),_=r(()=>t.sharedLink.expiresAt?ue.fromISO(t.sharedLink.expiresAt):void 0),L=r(()=>e(_)?$>e(_):!1);const Q=(i,T)=>{const U=["days","hours","minutes","seconds"],B=i.diff(T,U).toObject();for(const m of U){const d=B[m];if(d&&d>0)return i.toRelativeCalendar({base:T,locale:x(),unit:m})}},M=r(()=>Ne(l(),t.sharedLink)),w=r(()=>e(M).Edit),o=r(()=>e(M).Copy),P=r(()=>e(M).Delete),N=r(()=>{const i=[];return t.sharedLink.allowUpload&&i.push(l()("upload")),t.sharedLink.allowDownload&&i.push(l()("download")),t.sharedLink.showMetadata&&i.push(l()("exif")),t.sharedLink.password&&i.push(l()("password")),i});var R=Qe(),V=y(R);ze(V,()=>e(L)?"div":"a",!1,(i,T)=>{De(i,g=>({href:g,class:"flex gap-4 w-full py-4"}),[()=>e(L)?void 0:ge.viewSharedLink(t.sharedLink)]);var U=Ke(),B=J(U);He(B,{class:"transition-all duration-300 hover:shadow-lg",get sharedLink(){return t.sharedLink}});var m=p(B,2),d=y(m),A=y(d);{let g=r(()=>e(L)?"danger":"muted");ee(A,{size:"tiny",get color(){return e(g)},fontWeight:"medium",children:(F,q)=>{var b=fe(),H=J(b);{var Z=c=>{var f=z();O(E=>D(f,E),[()=>l()("expired")]),a(c,f)},k=c=>{var f=z();O(E=>D(f,E),[()=>l()("expires_date",{values:{date:Q(e(_),$)}})]),a(c,f)},u=c=>{var f=z();O(E=>D(f,E),[()=>l()("expires_date",{values:{date:"∞"}})]),a(c,f)};K(H,c=>{e(L)?c(Z):e(_)?c(k,1):c(u,!1)})}a(F,b)},$$slots:{default:!0}})}var G=p(A,2);ee(G,{size:"large",color:"primary",class:"flex place-items-center gap-2 break-all",fontWeight:"medium",children:(g,F)=>{var q=fe(),b=J(q);{var H=k=>{var u=z();O(()=>D(u,t.sharedLink.album?.albumName)),a(k,u)},Z=k=>{var u=z();O(c=>D(u,c),[()=>l()("individual_share")]),a(k,u)};K(b,k=>{t.sharedLink.type===re.Album?k(H):t.sharedLink.type===re.Individual&&k(Z,1)})}a(g,q)},$$slots:{default:!0}});var se=p(G,2);{var pe=g=>{ee(g,{size:"small",class:"line-clamp-1",children:(F,q)=>{ie();var b=z();O(()=>D(b,t.sharedLink.description)),a(F,b)},$$slots:{default:!0}})};K(se,g=>{t.sharedLink.description&&g(pe)})}h(d);var ve=p(d,2);_e(ve,21,()=>e(N),Se,(g,F,q)=>{var b=Je(),H=J(b);ee(H,{size:"small",color:"primary",fontWeight:"medium",children:(u,c)=>{ie();var f=z();O(()=>D(f,e(F))),a(u,f)},$$slots:{default:!0}});var Z=p(H,2);{var k=u=>{ee(u,{size:"small",color:"muted",children:(c,f)=>{ie();var E=z("•");a(c,E)},$$slots:{default:!0}})};K(Z,u=>{q<e(N).length-1&&u(k)})}a(g,b)}),h(ve),h(m),a(T,U)});var te=p(V,2),n=y(te),s=y(n);le(s,{get action(){return e(w)}});var S=p(s,2);le(S,{get action(){return e(o)}});var X=p(S,2);le(X,{get action(){return e(P)}}),h(n);var Y=p(n,2),W=y(Y);{let i=r(()=>l()("shared_link_options")),T=r(()=>[e(w),e(o),Oe.Divider,e(P)]);We(W,{get"aria-label"(){return e(i)},position:"top-right",get items(){return e(T)}})}h(Y),h(te),h(R),a(j,R),de(),v()}var Xe=C('<div class="hidden xl:block h-10"><!></div>'),Ye=C('<div class="flex place-content-center place-items-center rounded-lg bg-gray-100 dark:bg-immich-dark-gray dark:text-immich-gray p-12"><p> </p></div>'),Ze=C('<div class="flex flex-col gap-2"></div>'),et=C("<!> <!>",1),tt=C("<!> <!>",1);function At(j,t){ne(t,!0);const x=()=>ae(oe,"$t",l),[l,I]=ce();let v=ye(Le([]));const $=async()=>{me(v,await Re({}),!0)};ke(async()=>{await $()});const _={all:x()("all"),album:x()("albums"),individual:x()("individual_shares")};let L=Object.keys(_),Q=Object.values(_);const M=n=>{const s=n.searchParams.get("filter");return s&&L.includes(s)?s:"all"};let w=r(()=>M($e.url)),o=r(()=>e(v).filter(({type:n})=>e(w)==="all"||n===re.Album&&e(w)==="album"||n===re.Individual&&e(w)==="individual"));const P=n=>{const s=e(v).findIndex(S=>S.id===n.id);s!==-1&&(e(v)[s]=n)},N=n=>{me(v,e(v).filter(({id:s})=>s!==n.id),!0)};var R=tt(),V=J(R);Te(V,{onSharedLinkUpdate:P,onSharedLinkDelete:N});var te=p(V,2);Pe(te,{get title(){return t.data.meta.title},buttons:s=>{var S=Xe(),X=y(S);{let Y=r(()=>x()("show_shared_links"));Be(X,{get label(){return e(Y)},get filters(){return L},get labels(){return Q},get selected(){return e(w)},onSelect:W=>Ce(ge.sharedLinks({filter:W}))})}h(S),a(s,S)},children:(s,S)=>{Ge(s,{center:!0,size:"medium",children:(X,Y)=>{var W=et(),i=J(W);{var T=m=>{var d=Ye(),A=y(d),G=y(A,!0);h(A),h(d),O(se=>D(G,se),[()=>x()("you_dont_have_any_shared_links")]),a(m,d)},U=m=>{var d=Ze();_e(d,21,()=>e(o),A=>A.id,(A,G)=>{Ve(A,{get sharedLink(){return e(G)}})}),h(d),a(m,d)};K(i,m=>{e(v).length===0?m(T):m(U,!1)})}var B=p(i,2);Ae(B,()=>t.children??we),a(X,W)},$$slots:{default:!0}})},$$slots:{buttons:!0,default:!0}}),a(j,R),de(),I()}export{At as component,St as universal};
