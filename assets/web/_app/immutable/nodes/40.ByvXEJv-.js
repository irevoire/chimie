import{a as ct}from"../chunks/Cx5lmlld.js";import{g as dt,$ as st}from"../chunks/DdY9CyNE.js";import"../chunks/DsnmJJEf.js";import{p as rt,g as e,u as P,a as nt,f as Y,c as y,r as b,s as h,t as v,h as W,i as ut,b as mt,j as E,$ as Z,n as C}from"../chunks/BOqQhZBJ.js";import{s as u,e as tt}from"../chunks/BufZg4h2.js";import{f as D,a as l,c as pt,t as M}from"../chunks/CnteGC4G.js";import{i as et}from"../chunks/QS5y7wlf.js";import{s as it,a as lt}from"../chunks/B227BkWK.js";import{U as gt}from"../chunks/CwTmTzRk.js";import{C as ft}from"../chunks/ghntbn61.js";import{E as _t}from"../chunks/0tdQcI5E.js";import{T as vt}from"../chunks/-MdfcuX_.js";import{A as $t}from"../chunks/BNLYq5HQ.js";import{s as ht,a as xt}from"../chunks/C2I_EQjW.js";import{t as yt}from"../chunks/BIB7ntQe.js";import{A as bt,j as At,f as kt}from"../chunks/DeYUhNiz.js";import{a as ot}from"../chunks/Jagi0WJL.js";import{C as wt,m as at}from"../chunks/C20f7eOz.js";import{A as Ct}from"../chunks/DeL_lkPB.js";import{T as j,B as X,bm as Mt,a5 as Pt,bn as Tt}from"../chunks/LrV5ZTyj.js";const It=(async({url:T})=>(await ct(T),{meta:{title:(await dt())("manage_geolocation")}})),ae=Object.freeze(Object.defineProperty({__proto__:null,load:It},Symbol.toStringTag,{value:"Module"}));var St=D("<p> </p> <p> </p> <p> </p>",1);function zt(T,p){rt(p,!0);const r=()=>lt(st,"$t",F),[F,L]=it();{const o=I=>{var A=St(),S=Y(A),R=y(S,!0);b(S);var z=h(S,2),V=y(z);b(z);var U=h(z,2),K=y(U);b(U),v((G,O,H)=>{u(R,G),u(V,`- ${O??""}: ${p.location.latitude??""}`),u(K,`- ${H??""}: ${p.location.longitude??""}`)},[()=>r()("update_location_action_prompt",{values:{count:p.assetCount}}),()=>r()("latitude"),()=>r()("longitude")]),l(I,A)};let c=P(()=>r()("confirm"));wt(T,{get title(){return e(c)},size:"small",confirmColor:"primary",get onClose(){return p.onClose},prompt:o,$$slots:{prompt:!0}})}nt(),L()}var Ut=D('<div class="flex gap-2 justify-end place-items-center"><!> <div class="border flex place-items-center place-content-center px-2 py-1 bg-primary/10 rounded-2xl"><!> <!></div> <!> <!> <!></div>'),Et=D('<div class="absolute bottom-1 end-3 px-4 py-1 rounded-xl text-xs transition-colors bg-success text-black"> </div>'),jt=D('<div class="absolute bottom-1 end-3 px-4 py-1 rounded-xl text-xs transition-colors bg-danger text-light"> </div>'),Dt=D("<!> <!>",1);function se(T,p){rt(p,!0);const r=()=>lt(st,"$t",F),[F,L]=it();let o=new Ct,c=W(ut({latitude:0,longitude:0})),I=W(!1),A=W(void 0);const S={visibility:bt.Timeline,withStacked:!0,withPartners:!0,withCoordinates:!0},R=async()=>{if(!await at.show(zt,{location:e(c)??{latitude:0,longitude:0},assetCount:o.selectedAssets.length}))return;await At({assetBulkUpdateDto:{ids:o.selectedAssets.map(d=>d.id),latitude:e(c)?.latitude??void 0,longitude:e(c)?.longitude??void 0}});const x=await Promise.all(o.selectedAssets.map(async d=>{const g=await kt({...xt.params,id:d.id});return yt(g)}));e(A).upsertAssets(x),U()},z=t=>{t.key==="Shift"&&t.preventDefault(),t.key==="Escape"&&o.selectionActive&&ot(o)},V=t=>{t.key==="Shift"&&t.preventDefault()},U=()=>{ot(o)},K=async()=>{const t=await at.show(ft,{point:{lat:e(c).latitude,lng:e(c).longitude}});t&&E(c,{latitude:t.lat,longitude:t.lng},!0)},G=()=>{if(o.selectionActive){o.clearMultiselect();return}},O=t=>!!t.latitude&&!!t.longitude,H=(t,x,d,g)=>{O(t)?(E(I,!0),setTimeout(()=>{E(I,!1)},1500),E(c,{latitude:t.latitude,longitude:t.longitude},!0),ht("at",t.id)):g(x,d.getAssets(),d.groupTitle,t)};tt("keydown",Z,z),tt("keyup",Z,V),gt(T,{get title(){return p.data.meta.title},scrollbar:!0,buttons:x=>{var d=Ut(),g=y(d);j(g,{class:"hidden md:block mr-4",size:"tiny",color:"muted",children:(a,m)=>{C();var i=M();v(s=>u(i,s),[()=>r()("geolocation_instruction_location")]),l(a,i)},$$slots:{default:!0}});var k=h(g,2),B=y(k);j(B,{class:"hidden md:inline-block font-mono mr-5 ml-2",color:"muted",size:"tiny",children:(a,m)=>{C();var i=M();v(s=>u(i,s),[()=>r()("selected_gps_coordinates")]),l(a,i)},$$slots:{default:!0}});var Q=h(B,2);{let a=P(()=>e(I)?"bg-primary/90 text-light font-semibold scale-105":"");j(Q,{title:"latitude, longitude",get class(){return`rounded-3xl font-mono text-sm text-primary px-2 py-1 transition-all duration-100 ease-in-out ${e(a)??""}`},children:(m,i)=>{C();var s=M();v((f,n)=>u(s,`${f??""}, ${n??""}`),[()=>e(c).latitude.toFixed(3),()=>e(c).longitude.toFixed(3)]),l(m,s)},$$slots:{default:!0}})}b(k);var q=h(k,2);X(q,{size:"small",color:"secondary",variant:"ghost",get leadingIcon(){return Mt},onclick:K,children:(a,m)=>{j(a,{class:"hidden sm:inline-block",children:(i,s)=>{C();var f=M();v(n=>u(f,n),[()=>r()("location_picker_choose_on_map")]),l(i,f)},$$slots:{default:!0}})},$$slots:{default:!0}});var $=h(q,2);{let a=P(()=>!o.selectionActive);X($,{get leadingIcon(){return Pt},size:"small",color:"secondary",variant:"ghost",get disabled(){return e(a)},onclick:U,children:(m,i)=>{C();var s=M();v(f=>u(s,f),[()=>r()("unselect_all")]),l(m,s)},$$slots:{default:!0}})}var w=h($,2);{let a=P(()=>o.selectedAssets.length===0);X(w,{get leadingIcon(){return Tt},size:"small",color:"primary",get disabled(){return e(a)},onclick:()=>R(),children:(m,i)=>{j(m,{class:"hidden sm:inline-block",children:(s,f)=>{C();var n=M();v(_=>u(n,_),[()=>r()("apply_count",{values:{count:o.selectedAssets.length}})]),l(s,n)},$$slots:{default:!0}})},$$slots:{default:!0}})}b(d),l(x,d)},children:(x,d)=>{var g=Dt(),k=Y(g);et(k,Q=>{});var B=h(k,2);vt(B,{isSelectionMode:!0,enableRouting:!0,get options(){return S},get assetInteraction(){return o},get removeAction(){return $t.ARCHIVE},onEscape:G,withStacked:!0,onThumbnailClick:H,get timelineManager(){return e(A)},set timelineManager($){E(A,$,!0)},customThumbnailLayout:($,w=mt)=>{var a=pt(),m=Y(a);{var i=n=>{var _=Et(),J=y(_,!0);b(_),v(N=>u(J,N),[()=>w().city||r()("gps")]),l(n,_)},s=P(()=>O(w())),f=n=>{var _=jt(),J=y(_,!0);b(_),v(N=>u(J,N),[()=>r()("gps_missing")]),l(n,_)};et(m,n=>{e(s)?n(i):n(f,!1)})}l($,a)},empty:$=>{{let w=P(()=>r()("no_assets_message"));_t($,{get text(){return e(w)},onClick:()=>{},class:"mt-10 mx-auto"})}},$$slots:{customThumbnailLayout:!0,empty:!0}}),l(x,g)},$$slots:{buttons:!0,default:!0}}),nt(),L()}export{se as component,ae as universal};
