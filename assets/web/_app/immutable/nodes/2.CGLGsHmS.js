import{a as Z}from"../chunks/Cx5lmlld.js";import{d as tt,g as et,a as st,e as rt,c as at}from"../chunks/C2I_EQjW.js";import"../chunks/DsnmJJEf.js";import{p as I,$ as D,f as V,a as j,g as h,h as ot,a7 as nt,c as A,s as R,r as k,t as G,j as $,u as L,N as it,b as lt}from"../chunks/BOqQhZBJ.js";import{c as ct,a as S,f as O,s as dt}from"../chunks/CnteGC4G.js";import{L as ft,G as ut,ab as pt,u as mt}from"../chunks/LrV5ZTyj.js";import{s as z,a as C,d as T}from"../chunks/B227BkWK.js";import{p as i}from"../chunks/DbKlvrsB.js";import{e as d,s as gt}from"../chunks/BufZg4h2.js";import{i as yt}from"../chunks/QS5y7wlf.js";import{d as vt}from"../chunks/AeuhPEE0.js";import{f as ht}from"../chunks/BjCgVxgW.js";import{$ as _t}from"../chunks/DdY9CyNE.js";import{c as wt}from"../chunks/_U16pX41.js";import{a as bt}from"../chunks/ngppk3MK.js";const Ft=(async({url:l,params:o,route:c})=>(await Z(l,{public:tt(c.id)}),{asset:await et(o)})),Mt=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));var Dt=O('<div class="fixed inset-0 flex h-full w-full flex-col items-center justify-center bg-gray-100/90 text-immich-dark-gray dark:bg-immich-dark-bg/90 dark:text-immich-gray"><!> <div class="text-2xl"> </div></div>');function $t(l,o){I(o,!0);const c=()=>C(_t,"$t",f),[f,_]=z();let u=L(()=>at(i.route?.id)?i.params.albumId:void 0),w=L(()=>rt(i.route.id)),a=ot(null);const p=t=>{t.dataTransfer&&t.dataTransfer.types.includes("Files")&&$(a,t.target,!0)},n=t=>{h(a)===t.target&&$(a,null)},m=async t=>{$(a,null),await g(t.dataTransfer)},b=t=>{if(!wt(t))return g(t.clipboardData)},g=async t=>{if(!t)return;if(!F())return E(t.files);const e=[],s=[];for(const y of t.items){const v=y.webkitGetAsEntry();if(v){e.push(v);continue}const P=y.getAsFile();P&&s.push(P)}const r=await M(e);return E([...s,...r])},F=()=>typeof DataTransferItem.prototype.webkitGetAsEntry=="function",M=async t=>{const e=[];let s=[...t];for(;s.length>0;){const r=s.pop();U(r)?s=s.concat(await B(r)):H(r)&&e.push(await N(r))}return e},U=t=>!!t&&t.isDirectory,H=t=>!!t&&t.isFile,N=async t=>new Promise((e,s)=>{t.file(e,s)}),q=t=>new Promise((e,s)=>{t.readEntries(e,s)}),B=async t=>{const e=t.createReader(),s=[];let r;do r=await q(e),s.push(...r);while(r.length>0);return s},E=async t=>{if(!t)return;const e=Array.from(t);st.isSharedLink?vt.set({isDragging:!0,files:e}):await ht({files:e,albumId:h(u),isLockedAssets:h(w)})},J=t=>{t.preventDefault(),t.stopPropagation(),p(t)},K=t=>{t.preventDefault(),t.stopPropagation(),n(t)},Q=async t=>{t.preventDefault(),t.stopPropagation(),await m(t)},W=t=>{t.preventDefault(),t.stopPropagation()};var x=ct();d("paste",nt,b),d("dragenter",D.body,J),d("dragleave",D.body,K),d("drop",D.body,Q);var X=V(x);{var Y=t=>{var e=Dt(),s=A(e);ft(s,{variant:"icon",size:"giant",class:"m-16 animate-bounce"});var r=R(s,2),y=A(r,!0);k(r),k(e),G(v=>gt(y,v),[()=>c()("drop_files_to_upload")]),d("dragover",e,W),ut(3,e,()=>pt,()=>({duration:250})),S(t,e)};yt(X,t=>{h(a)&&t(Y)})}S(l,x),j(),_()}var At=O("<div><!></div> <!>",1);function Ut(l,o){I(o,!0);const c=()=>C(u,"$showAssetViewer",f),[f,_]=z();let{isViewing:u,setAsset:w,gridScrollTarget:a}=bt;it(()=>{i.data.asset?w(i.data.asset):T(u,!1);const F=i.url.searchParams.get("at");T(a,{at:F})});var p=At(),n=V(p);let m;var b=A(n);dt(b,()=>o.children??lt),k(n);var g=R(n,2);$t(g,{}),G(()=>m=mt(n,1,"svelte-nskuw0",null,m,{"display-none":c()})),S(l,p),j(),_()}export{Ut as component,Mt as universal};
