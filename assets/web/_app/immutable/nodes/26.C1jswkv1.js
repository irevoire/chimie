import{a as Ge,p as He,u as Ke}from"../chunks/Cx5lmlld.js";import{g as Qe,$ as ve}from"../chunks/DdY9CyNE.js";import"../chunks/DsnmJJEf.js";import{p as ne,f as C,g as e,u as m,a as ie,b as Xe,s as r,c as N,t as oe,j as O,h as q,r as z}from"../chunks/BOqQhZBJ.js";import{c as Y,a as h,f as L,s as Ye}from"../chunks/CnteGC4G.js";import{i as b}from"../chunks/QS5y7wlf.js";import{p as Z,c as Ze,s as fe,a as j}from"../chunks/B227BkWK.js";import{b as et}from"../chunks/C4XZXykC.js";import{A as ce}from"../chunks/CT-ELVN-.js";import{U as tt}from"../chunks/CwTmTzRk.js";import{B as Me}from"../chunks/Ydc33-3A.js";import{E as st}from"../chunks/0tdQcI5E.js";import{C as at,A as Te}from"../chunks/D3TI8oak.js";import{F as ot,A as rt}from"../chunks/CJ8Y9ewd.js";import{C as nt,a as it}from"../chunks/Td-V8-DQ.js";import{C as lt,T as ct}from"../chunks/BgebDwf7.js";import{D as mt}from"../chunks/DbL3L5r_.js";import{D as Ve}from"../chunks/CAJBNUk5.js";import{a as dt}from"../chunks/C2I_EQjW.js";import{g as ge}from"../chunks/Dw326QmB.js";import{e as ut,h as Pe}from"../chunks/D4fmOnVC.js";import{t as X,g as vt}from"../chunks/BIB7ntQe.js";import{a7 as Ue,f as ft,A as gt}from"../chunks/DeYUhNiz.js";import{q as pt,i as ht,u as me,s as de,cK as De,I as re,cL as _t,G as Re,ab as Oe,bD as At,l as Be,cM as kt,bf as bt,a2 as yt,ai as It,cN as wt,ae as xt,af as $t}from"../chunks/LrV5ZTyj.js";import{M as ue}from"../chunks/ClWsMFS7.js";import{S as St}from"../chunks/KeI0xpXW.js";import{S as Ct}from"../chunks/P5k8Owjv.js";import{a5 as Lt,a6 as Mt,t as Tt,a7 as Vt}from"../chunks/Jagi0WJL.js";import{A as Pt}from"../chunks/DYbeYGSx.js";import{T as Ut}from"../chunks/-MdfcuX_.js";import{A as Dt}from"../chunks/BNLYq5HQ.js";import{R as Rt}from"../chunks/BeWG-__C.js";import{g as Ot}from"../chunks/Bc5ULZvy.js";import{A as Bt}from"../chunks/DeL_lkPB.js";import{a as Ft}from"../chunks/ngppk3MK.js";import{i as jt}from"../chunks/BSBkdVh4.js";import{m as Et}from"../chunks/C2jcabg9.js";import{u as zt,b as Wt}from"../chunks/CH9-R8qO.js";import{o as Jt}from"../chunks/BjCgVxgW.js";import{e as Nt,s as qt}from"../chunks/BufZg4h2.js";import{b as Fe}from"../chunks/9i_j0jQI.js";const Gt=(w,t=Xe)=>{var i=Ht(),x=N(i),M=r(x,4),d=N(M,!0);z(M),z(i),oe(()=>{de(i,"href",t().href),de(x,"src",t().src),de(x,"alt",t().alt??t().title),qt(d,t().title)}),h(w,i)};var Ht=L('<a class="item-card relative me-2 inline-block aspect-3/4 h-54 rounded-xl last:me-0 max-md:h-37.5 md:me-4 md:aspect-4/3 xl:aspect-video svelte-scsjux"><img class="h-full w-full rounded-xl object-cover" draggable="false"/> <div class="absolute start-0 top-0 h-full w-full rounded-xl bg-linear-to-t from-black/40 via-transparent to-transparent transition-all hover:bg-black/20"></div> <p class="absolute start-4 bottom-2 text-lg text-white max-md:text-sm"> </p></a>'),Kt=L('<div class="light absolute start-4 top-27 -translate-y-1/2 max-md:top-19"><!></div>'),Qt=L("<div><!></div>"),Xt=L("<div><!> <!></div>"),Yt=L('<section style="scrollbar-width:none"><!> <div class="inline-block"></div></section>');function Zt(w,t){ne(t,!0);const i=Z(t,"scrollBy",3,400),x=Z(t,"child",3,Gt);let M=m(()=>t.items.length>0),d=q(void 0),$=q(0),k=q(0),_=q(0),P=m(()=>e(_)>0),T=m(()=>Math.ceil(e(_))<Math.floor(e(k)-e($)));const n=()=>{O(_,e(d)?.scrollLeft??0,!0)},B=()=>e(d)?.scrollBy({left:-i(),behavior:"smooth"}),l=()=>e(d)?.scrollBy({left:i(),behavior:"smooth"});var a=Y(),v=C(a);{var U=D=>{var S=Yt(),W=N(S);{var c=s=>{var A=Xt(),V=N(A);{var I=g=>{var p=Kt(),y=N(p);{let R=m(()=>Be("navigate_previous",t.translations));re(y,{get icon(){return _t},shape:"round",variant:"outline",color:"secondary",class:"opacity-50 hover:opacity-100",size:"giant",get"aria-label"(){return e(R)},onclick:B})}z(p),Re(3,p,()=>Oe,()=>({duration:200})),h(g,p)};b(V,g=>{e(P)&&g(I)})}var G=r(V,2);{var o=g=>{var p=Qt(),y=N(p);{let R=m(()=>Be("navigate_next",t.translations));re(y,{get icon(){return At},shape:"round",variant:"outline",color:"secondary",class:"opacity-50 hover:opacity-100",size:"giant",get"aria-label"(){return e(R)},onclick:l})}z(p),oe(()=>me(p,1,`light absolute end-4 top-27 ${De.CarouselImage} -translate-y-1/2 max-md:top-19`,"svelte-scsjux")),Re(3,p,()=>Oe,()=>({duration:200})),h(g,p)};b(G,g=>{e(T)&&g(o)})}z(A),oe(()=>me(A,1,`sticky start-0 ${De.CarouselImage}`,"svelte-scsjux")),h(s,A)};b(W,s=>{(e(P)||e(T))&&s(c)})}var f=r(W,2);ut(f,23,()=>t.items,(s,A)=>s.id??A,(s,A)=>{var V=Y(),I=C(V);Ye(I,x,()=>e(A)),h(s,V)}),z(f),z(S),Ze(S,s=>O(d,s),()=>e(d)),oe(s=>me(S,1,s,"svelte-scsjux"),[()=>pt(ht("relative mt-3 overflow-x-scroll overflow-y-hidden whitespace-nowrap transition-all",t.class))]),Nt("scroll",S,n),Fe(f,"clientWidth",s=>O(k,s)),Fe(S,"clientWidth",s=>O($,s)),h(D,S)};b(v,D=>{e(M)&&D(U)})}h(w,a),ie()}const es=(async({url:w})=>(await Ge(w),{meta:{title:(await Qe())("photos")}})),Qs=Object.freeze(Object.defineProperty({__proto__:null,load:es},Symbol.toStringTag,{value:"Module"}));var ts=L("<!> <!>",1);function ss(w,t){ne(t,!0);const i=()=>j(ve,"$t",x),[x,M]=fe();let d=Z(t,"menuItem",3,!1),$=Z(t,"unlink",3,!1),k=q(!1),_=m(()=>$()?i()("unlink_motion_video"):i()("link_motion_video")),P=m(()=>$()?kt:bt);const{clearSelect:T,getOwnedAssets:n}=ge(),B=()=>$()?a():l(),l=async()=>{let[c,f]=[...n()];c.isVideo&&([c,f]=[f,c]);try{O(k,!0);const s=await Ue({id:c.id,updateAssetDto:{livePhotoVideoId:f.id}});t.onLink({still:X(s),motion:f}),T()}catch(s){Pe(s,i()("errors.unable_to_link_motion_video"))}finally{O(k,!1)}},a=async()=>{const[c]=[...n()];if(!c)return;const f=c.livePhotoVideoId;if(f)try{O(k,!0);const s=await Ue({id:c.id,updateAssetDto:{livePhotoVideoId:null}}),A=await ft({...dt.params,id:f});t.onUnlink({still:X(s),motion:X(A)}),T()}catch(s){Pe(s,i()("errors.unable_to_unlink_motion_video"))}finally{O(k,!1)}};var v=ts(),U=C(v);{var D=c=>{ue(c,{get text(){return e(_)},get icon(){return e(P)},onClick:B})};b(U,c=>{d()&&c(D)})}var S=r(U,2);{var W=c=>{var f=Y(),s=C(f);{var A=I=>{{let G=m(()=>i()("loading"));re(I,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(G)},get icon(){return yt},onclick:()=>{}})}},V=I=>{re(I,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(_)},get icon(){return e(P)},onclick:B})};b(s,I=>{e(k)?I(A):I(V,!1)})}h(c,f)};b(S,c=>{d()||c(W)})}h(w,v),ie(),M()}function as(w,t){ne(t,!0);const i=()=>j(ve,"$t",x),[x,M]=fe();let d=Z(t,"unstack",3,!1);const{clearSelect:$,getOwnedAssets:k}=ge(),_=async()=>{const a=[...k()],v=await Mt(a);t.onStack?.(v),$()},P=async()=>{const a=[...k()];if(a.length!==1)return;const{stack:v}=a[0];if(!v)return;const U=await Lt([v.id]);U&&t.onUnstack?.(U.map(D=>X(D))),$()};var T=Y(),n=C(T);{var B=a=>{{let v=m(()=>i()("unstack"));ue(a,{get text(){return e(v)},get icon(){return It},onClick:P})}},l=a=>{{let v=m(()=>i()("stack"));ue(a,{get text(){return e(v)},get icon(){return wt},onClick:_})}};b(n,a=>{d()?a(B):a(l,!1)})}h(w,T),ie(),M()}var os=L("<!> <!>",1),rs=L("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <hr/> <!> <!> <!>",1),ns=L("<!> <!>",1),is=L("<!> <!> <!> <!>",1),ls=L("<!> <!>",1);function Xs(w,t){ne(t,!0);const i=()=>j(Ke,"$user",_),x=()=>j(T,"$showAssetViewer",_),M=()=>j(Vt,"$memoryLaneTitle",_),d=()=>j(ve,"$t",_),$=()=>j(vt,"$getAltText",_),k=()=>j(He,"$preferences",_),[_,P]=fe();let{isViewing:T}=Ft,n=q(void 0);const B={visibility:gt.Timeline,withStacked:!0,withPartners:!0},l=new Bt;let a=m(()=>l.selectedAssets),v=m(()=>e(a).length===1&&!!e(a)[0].stack),U=m(()=>{const o=e(a).length===1&&!!e(a)[0].livePhotoVideoId,g=e(a).length===2&&e(a).some(p=>p.isImage)&&e(a).some(p=>p.isVideo);return l.isAllUserOwned&&(o||g)});const D=m(()=>i()&&e(a).every(o=>o.ownerId===i().id)),S=()=>{if(!x()&&l.selectionActive){l.clearMultiselect();return}},W=({still:o,motion:g})=>{e(n).removeAssets([g.id]),e(n).upsertAssets([o])},c=({still:o,motion:g})=>{e(n).upsertAssets([g]),e(n).upsertAssets([o])},f=o=>{e(n).removeAssets(o),l.clearMultiselect()};et(()=>{jt.value=!1});const s=m(()=>Et.memories.map(o=>({id:o.id,title:M()(o),href:Rt.memories({id:o.assets[0].id}),alt:d()("memory_lane_title",{values:{title:$()(X(o.assets[0]))}}),src:Tt({id:o.assets[0].id})})));var A=ls(),V=C(A);tt(V,{get hideNavbar(){return l.selectionActive},scrollbar:!1,children:(o,g)=>{Ut(o,{enableRouting:!0,get options(){return B},get assetInteraction(){return l},get removeAction(){return Dt.ARCHIVE},onEscape:S,withStacked:!0,get timelineManager(){return e(n)},set timelineManager(y){O(n,y,!0)},empty:y=>{{let R=m(()=>d()("no_assets_message"));st(y,{get text(){return e(R)},onClick:()=>Jt(),class:"mt-10 mx-auto"})}},children:(y,R)=>{var H=Y(),ee=C(H);{var te=K=>{Zt(K,{get items(){return e(s)}})};b(ee,K=>{k().memories.enabled&&K(te)})}h(y,H)},$$slots:{empty:!0,default:!0}})},$$slots:{default:!0}});var I=r(V,2);{var G=o=>{Pt(o,{get ownerId(){return i().id},get assets(){return l.selectedAssets},clearSelect:()=>l.clearMultiselect(),children:(g,p)=>{const y=m(()=>Ot(d(),ge()));var R=is(),H=C(R);at(H,{});var ee=r(H,2);St(ee,{get timelineManager(){return e(n)},get assetInteraction(){return l}});var te=r(ee,2);{let F=m(()=>d()("add_to"));Me(te,{get icon(){return xt},get title(){return e(F)},children:(se,le)=>{var ae=os(),J=C(ae);Te(J,{});var Q=r(J,2);Te(Q,{shared:!0}),h(se,ae)},$$slots:{default:!0}})}var K=r(te,2);{var je=F=>{var se=ns(),le=C(se);ot(le,{get removeFavorite(){return l.isAllFavorite},onFavorite:(J,Q)=>e(n).update(J,pe=>pe.isFavorite=Q)});var ae=r(le,2);{let J=m(()=>d()("menu"));Me(ae,{get icon(){return $t},get title(){return e(J)},children:(Q,pe)=>{var he=rs(),_e=C(he);Ve(_e,{menuItem:!0});var Ae=r(_e,2);{var ze=u=>{as(u,{get unstack(){return e(v)},onStack:E=>Wt(e(n),E),onUnstack:E=>zt(e(n),E)})};b(Ae,u=>{(l.selectedAssets.length>1||e(v))&&u(ze)})}var ke=r(Ae,2);{var We=u=>{{let E=m(()=>l.selectedAssets.length===1);ss(u,{menuItem:!0,get unlink(){return e(E)},onLink:W,onUnlink:c})}};b(ke,u=>{e(U)&&u(We)})}var be=r(ke,2);nt(be,{menuItem:!0});var ye=r(be,2);lt(ye,{menuItem:!0});var Ie=r(ye,2);it(Ie,{menuItem:!0});var we=r(Ie,2);rt(we,{menuItem:!0,onArchive:(u,E)=>e(n).update(u,qe=>qe.visibility=E)});var xe=r(we,2);{var Je=u=>{ct(u,{menuItem:!0})};b(xe,u=>{k().tags.enabled&&u(Je)})}var $e=r(xe,2);mt($e,{menuItem:!0,onAssetDelete:u=>e(n).removeAssets(u),onUndoDelete:u=>e(n).upsertAssets(u)});var Se=r($e,2);Ct(Se,{menuItem:!0,onVisibilitySet:f});var Ce=r(Se,4);ce(Ce,{get action(){return e(y).RegenerateThumbnailJob}});var Le=r(Ce,2);ce(Le,{get action(){return e(y).RefreshMetadataJob}});var Ne=r(Le,2);ce(Ne,{get action(){return e(y).TranscodeVideoJob}}),h(Q,he)},$$slots:{default:!0}})}h(F,se)},Ee=F=>{Ve(F,{})};b(K,F=>{e(D)?F(je):F(Ee,!1)})}h(g,R)},$$slots:{default:!0}})};b(I,o=>{l.selectionActive&&o(G)})}h(w,A),ie(),P()}export{Xs as component,Qs as universal};
